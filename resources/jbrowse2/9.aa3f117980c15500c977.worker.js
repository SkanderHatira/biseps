this.webpackChunk([9],{1003:function(e,t,n){var r=n(943);e.exports=function(e,t){if(null==e)return{};var n,i,a=r(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a},e.exports.__esModule=!0,e.exports.default=e.exports},1006:function(e,t,n){"use strict";n.r(t),n.d(t,"unescape",(function(){return s})),n.d(t,"escape",(function(){return u})),n.d(t,"escapeColumn",(function(){return c})),n.d(t,"parseAttributes",(function(){return f})),n.d(t,"parseFeature",(function(){return h})),n.d(t,"parseDirective",(function(){return l})),n.d(t,"formatAttributes",(function(){return d})),n.d(t,"formatFeature",(function(){return b})),n.d(t,"formatDirective",(function(){return m})),n.d(t,"formatComment",(function(){return g})),n.d(t,"formatSequence",(function(){return y})),n.d(t,"formatItem",(function(){return k}));var r=n(5),i=n(6),a=n(15);function s(e){return e.replace(/%([0-9A-Fa-f]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}))}function o(e,t){return String(t).replace(e,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0");return"%".concat(t)}))}function u(e){return o(/[\n;\r\t=%&,\x00-\x1f\x7f-\xff]/g,e)}function c(e){return o(/[\n\r\t%\x00-\x1f\x7f-\xff]/g,e)}function f(e){if(!e||!e.length||"."===e)return{};var t={};return e.replace(/\r?\n$/,"").split(";").forEach((function(e){var n,r=e.split("=",2);if(r[1]&&r[1].length){r[0]=r[0].trim();var i=t[r[0].trim()];i||(i=[],t[r[0]]=i),(n=i).push.apply(n,Object(a.a)(r[1].split(",").map((function(e){return e.trim()})).map(s)))}})),t}function h(e){var t=e.split("\t").map((function(e){return"."===e||""===e?null:e}));return{seq_id:t[0]&&s(t[0]),source:t[1]&&s(t[1]),type:t[2]&&s(t[2]),start:null===t[3]?null:parseInt(t[3],10),end:null===t[4]?null:parseInt(t[4],10),score:null===t[5]?null:parseFloat(t[5]),strand:t[6],phase:t[7],attributes:null===t[8]?null:f(t[8])}}function l(e){var t=/^\s*##\s*(\S+)\s*(.*)/.exec(e);if(!t)return null;var n=Object(i.a)(t,2)[1],a=Object(i.a)(t,3)[2],s={directive:n};if(a.length&&(a=a.replace(/\r?\n$/,""),s.value=a),"sequence-region"===n){var o=a.split(/\s+/,3);return Object(r.a)(Object(r.a)({},s),{},{seq_id:o[0],start:o[1]&&o[1].replace(/\D/g,""),end:o[2]&&o[2].replace(/\D/g,"")})}if("genome-build"===n){var u=a.split(/\s+/,2),c=Object(i.a)(u,2),f=c[0],h=c[1];return Object(r.a)(Object(r.a)({},s),{},{source:f,buildName:h})}return s}function d(e){var t=[];return Object.entries(e).forEach((function(e){var n,r=Object(i.a)(e,2),a=r[0],s=r[1];s&&(n=s.hasOwnProperty("toString")?u(s.toString()):Array.isArray(s)?s.map(u).join(","):u(s),t.push("".concat(u(a),"=").concat(n)))})),t.length?t.join(";"):"."}function v(e,t){var n=null===e.attributes||void 0===e.attributes?".":d(e.attributes),r=[null===e.seq_id?".":c(e.seq_id),null===e.source?".":c(e.source),null===e.type?".":c(e.type),null===e.start?".":c(e.start),null===e.end?".":c(e.end),null===e.score?".":c(e.score),null===e.strand?".":c(e.strand),null===e.phase?".":c(e.phase),n],i="".concat(r.join("\t"),"\n");return t[i]?"":(t[i]=!0,i)}function p(e,t){if(Array.isArray(e))return e.map((function(e){return p(e,t)})).join("");var n,r=[v(e,t)];return void 0!==(n=e).child_features&&void 0!==n.derived_features&&r.push.apply(r,Object(a.a)(e.child_features.map((function(e){return p(e,t)}))).concat(Object(a.a)(e.derived_features.map((function(e){return p(e,t)}))))),r.join("")}function b(e){return p(e,{})}function m(e){var t="##".concat(e.directive);return e.value&&(t+=" ".concat(e.value)),t+="\n"}function g(e){return"# ".concat(e.comment,"\n")}function y(e){return">".concat(e.id).concat(e.description?" ".concat(e.description):"","\n").concat(e.sequence,"\n")}function k(e){function t(e){return"attributes"in e?b(e):"directive"in e?m(e):"sequence"in e?y(e):"comment"in e?g(e):"# (invalid item found during format)\n"}return Array.isArray(e)?e.map(t):t(e)}},1047:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CSI=t.TBI=t.TabixIndexedFile=void 0;var i=r(n(1048));t.TabixIndexedFile=i.default;var a=r(n(967));t.TBI=a.default;var s=r(n(971));t.CSI=s.default},1048:function(e,t,n){"use strict";(function(e){var r=n(2),i=n(653).default,a=n(111).default,s=n(112).default,o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(914)),c=o(n(923)),f=n(113),h=n(120),l=n(940),d=o(n(967)),v=o(n(971));function p(e){return new Promise((function(t){setTimeout(t,e)}))}var b=function(){function t(e){var n=e.path,r=e.filehandle,i=e.tbiPath,s=e.tbiFilehandle,o=e.csiPath,h=e.csiFilehandle,l=e.chunkSizeLimit,p=void 0===l?5e7:l,b=e.renameRefSeqs,m=void 0===b?function(e){return e}:b,g=e.chunkCacheSize,y=void 0===g?5*Math.pow(2,20):g;if(a(this,t),r)this.filehandle=r;else{if(!n)throw new TypeError("must provide either filehandle or path");this.filehandle=new f.LocalFile(n)}if(s)this.index=new d.default({filehandle:s,renameRefSeqs:m});else if(h)this.index=new v.default({filehandle:h,renameRefSeqs:m});else if(i)this.index=new d.default({filehandle:new f.LocalFile(i),renameRefSeqs:m});else if(o)this.index=new v.default({filehandle:new f.LocalFile(o),renameRefSeqs:m});else{if(!n)throw new TypeError("must provide one of tbiFilehandle, tbiPath, csiFilehandle, or csiPath");this.index=new d.default({filehandle:new f.LocalFile("".concat(n,".tbi")),renameRefSeqs:m})}this.chunkSizeLimit=p,this.renameRefSeq=m,this.chunkCache=new u.default({cache:new c.default({maxSize:Math.floor(y/65536)}),fill:this.readChunk.bind(this)})}return s(t,[{key:"getLines",value:function(){var e=i(r.mark((function e(t,n,i,a){var s,o,u,c,f,h,d,v,b,m,g,y,k,w,x,_,S,C,E,O,I,L,j;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={},"undefined"!==typeof a){e.next=3;break}throw new TypeError("line callback must be provided");case 3:if("function"===typeof a?u=a:(o=a,u=a.lineCallback),void 0!==t){e.next=6;break}throw new TypeError("must provide a reference sequence name");case 6:if(u){e.next=8;break}throw new TypeError("line callback must be provided");case 8:return e.next=10,this.index.getMetadata(o);case 10:if(c=e.sent,(0,l.checkAbortSignal)(s),n||(n=0),i||(i=c.maxRefLength),n<=i){e.next=16;break}throw new TypeError("invalid start and end coordinates. start must be less than or equal to end");case 16:if(n!==i){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,this.index.blocksForRange(t,n,i,o);case 20:f=e.sent,(0,l.checkAbortSignal)(s),h=0;case 23:if(!(h<f.length)){e.next=30;break}if(!((d=f[h].fetchedSize())>this.chunkSizeLimit)){e.next=27;break}throw new Error("Too much data. Chunk size ".concat(d.toLocaleString()," bytes exceeds chunkSizeLimit of ").concat(this.chunkSizeLimit.toLocaleString(),"."));case 27:h+=1,e.next=23;break;case 30:v=Date.now(),b=0;case 32:if(!(b<f.length)){e.next=72;break}return m=void 0,g=f[b],e.next=37,this.chunkCache.get(g.toString(),g,s);case 37:y=e.sent,k=y.buffer,w=y.cpositions,x=y.dpositions,(_=("undefined"!==typeof TextDecoder?new TextDecoder("utf-8").decode(k):k.toString()).split("\n")).pop(),(0,l.checkAbortSignal)(s),S=g.minv.dataPosition,C=void 0,E=0;case 47:if(!(E<_.length)){e.next=69;break}for(O=_[E],C=0;S>=x[C];C+=1);if(I=this.checkLine(c,t,n,i,O),L=I.startCoordinate,j=I.overlaps,!(void 0!==m&&void 0!==L&&m>L)){e.next=53;break}throw new Error("Lines not sorted by start coordinate (".concat(m," > ").concat(L,"), this file is not usable with Tabix."));case 53:if(m=L,!j){e.next=58;break}u(O.trim(),256*w[C]+(S-x[C])),e.next=60;break;case 58:if(!(void 0!==L&&L>=i)){e.next=60;break}return e.abrupt("return");case 60:if(S+=O.length+1,!(v-Date.now()>500)){e.next=66;break}return v=Date.now(),(0,l.checkAbortSignal)(s),e.next=66,p(1);case 66:E+=1,e.next=47;break;case 69:b+=1,e.next=32;break;case 72:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var e=i(r.mark((function e(){var t,n=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",this.index.getMetadata(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeaderBuffer",value:function(){var e=i(r.mark((function e(){var t,n,i,a,s,o,u,c,f,d,v,p=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},e.next=3,this.getMetadata(t);case 3:return n=e.sent,i=n.firstDataLine,a=n.metaChar,s=n.maxBlockSize,(0,l.checkAbortSignal)(t.signal),o=i&&i.blockPosition?i.blockPosition+s:s,e.next=11,this._readRegion(0,o,t);case 11:return u=e.sent,(0,l.checkAbortSignal)(t.signal),e.prev=13,e.next=16,(0,h.unzip)(u);case 16:u=e.sent,e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(13),console.error(e.t0),new Error("error decompressing block ".concat(e.t0.code," at 0 (length ").concat(o,") ").concat(e.t0));case 23:if(!a){e.next=36;break}c=-1,f="\n".charCodeAt(0),d=a.charCodeAt(0),v=0;case 28:if(!(v<u.length)){e.next=35;break}if(v!==c+1||u[v]===d){e.next=31;break}return e.abrupt("break",35);case 31:u[v]===f&&(c=v);case 32:v+=1,e.next=28;break;case 35:u=u.slice(0,c+1);case 36:return e.abrupt("return",u);case 37:case"end":return e.stop()}}),e,this,[[13,19]])})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=i(r.mark((function e(){var t,n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,this.getHeaderBuffer(t);case 3:return n=e.sent,(0,l.checkAbortSignal)(t.signal),e.abrupt("return",n.toString("utf8"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getReferenceSequenceNames",value:function(){var e=i(r.mark((function e(){var t,n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},e.next=3,this.getMetadata(t);case 3:return n=e.sent,e.abrupt("return",n.refIdToName);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkLine",value:function(e,t,n,r,i){var a=e.columnNumbers,s=e.metaChar,o=e.coordinateType,u=e.format;if(i.charAt(0)===s)return{overlaps:!1};var c=a.ref,f=a.start,h=a.end;c||(c=0),f||(f=0),h||(h=0),"VCF"===u&&(h=8);for(var l=Math.max(c,f,h),d=1,v=0,p="",b=-1/0,m=0;m<i.length+1;m+=1)if("\t"===i[m]||m===i.length){if(d===c){if(this.renameRefSeq(i.slice(v,m))!==t)return{overlaps:!1}}else if(d===f){if(b=parseInt(i.slice(v,m),10),"1-based-closed"===o&&(b-=1),b>=r)return{startCoordinate:b,overlaps:!1};if((0===h||h===f)&&b+1<=n)return{startCoordinate:b,overlaps:!1}}else if("VCF"===u&&4===d)p=i.slice(v,m);else if(d===h){if(("VCF"===u?this._getVcfEnd(b,p,i.slice(v,m)):parseInt(i.slice(v,m),10))<=n)return{overlaps:!1}}if(v=m+1,(d+=1)>l)break}return{startCoordinate:b,overlaps:!0}}},{key:"_getVcfEnd",value:function(e,t,n){var r=e+t.length,i=-1!==n.indexOf("SVTYPE=TRA");if("."===n[0]||i){if(i)return e+1}else for(var a=";",s=0;s<n.length;s+=1){if(";"===a&&"END="===n.slice(s,s+4)){var o=n.indexOf(";",s);-1===o&&(o=n.length),r=parseInt(n.slice(s+4,o),10);break}a=n[s]}return r}},{key:"lineCount",value:function(){var e=i(r.mark((function e(t){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",this.index.lineCount(t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_readRegion",value:function(){var t=i(r.mark((function t(n,i){var a,s,o,u,c=arguments;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>2&&void 0!==c[2]?c[2]:{},t.next=3,this.filehandle.read(e.alloc(i),0,i,n,a);case 3:return s=t.sent,o=s.bytesRead,u=s.buffer,t.abrupt("return",o<i?u.slice(0,o):u);case 7:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"readChunk",value:function(){var e=i(r.mark((function e(t){var n,i,a=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:{},e.next=3,this._readRegion(t.minv.blockPosition,t.fetchedSize(),n);case 3:return i=e.sent,e.prev=4,e.abrupt("return",(0,h.unzipChunkSlice)(i,t));case 8:throw e.prev=8,e.t0=e.catch(4),new Error("error decompressing chunk ".concat(t.toString()," ").concat(e.t0));case 11:case"end":return e.stop()}}),e,this,[[4,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}();t.default=b}).call(this,n(64).Buffer)},1052:function(e,t,n){e.exports=i;var r=n(422).EventEmitter;function i(){r.call(this)}n(162)(i,r),i.Readable=n(415),i.Writable=n(1053),i.Duplex=n(1054),i.Transform=n(1055),i.PassThrough=n(1056),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",o),n.on("close",u));var s=!1;function o(){s||(s=!0,e.end())}function u(){s||(s=!0,"function"===typeof e.destroy&&e.destroy())}function c(e){if(f(),0===r.listenerCount(this,"error"))throw e}function f(){n.removeListener("data",i),e.removeListener("drain",a),n.removeListener("end",o),n.removeListener("close",u),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",f),n.removeListener("close",f),e.removeListener("close",f)}return n.on("error",c),e.on("error",c),n.on("end",f),n.on("close",f),e.on("close",f),e.emit("pipe",n),e}},1053:function(e,t,n){e.exports=n(423)},1054:function(e,t,n){e.exports=n(179)},1055:function(e,t,n){e.exports=n(415).Transform},1056:function(e,t,n){e.exports=n(415).PassThrough},1196:function(e,t,n){"use strict";var r=n(1197),i=n(1006);t.a={parseStream:r.d,parseStringSync:r.e,formatSync:r.c,formatStream:r.b,formatFile:r.a,util:i}},1197:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return w}));var r=n(12),i=n(11),a=n(138),s=n(17),o=n(18),u=n(5),c=n(1052),f=n(424),h=n(1198),l=n(1006);function d(t){e&&e.nextTick?e.nextTick(t):t()}function v(e){var t=Object(u.a)({encoding:"utf8",parseFeatures:!0,parseDirectives:!1,parseSequences:!0,parseComments:!1,bufferSize:1e3},e);return e.parseAll&&(t.parseFeatures=!0,t.parseDirectives=!0,t.parseComments=!0,t.parseSequences=!0),t}var p=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,n),(e=t.call(this,{objectMode:!0})).textBuffer="";var s=v(i);e.encoding=i.encoding||"utf8",e.decoder=new f.StringDecoder;var o=e.push.bind(Object(a.a)(e));return e.parser=new h.a({featureCallback:s.parseFeatures?o:void 0,directiveCallback:s.parseDirectives?o:void 0,commentCallback:s.parseComments?o:void 0,sequenceCallback:s.parseSequences?o:void 0,errorCallback:function(t){return e.emit("error",t)},bufferSize:s.bufferSize}),e}return Object(i.a)(n,[{key:"_addLine",value:function(e){e&&this.parser.addLine(e)}},{key:"_nextText",value:function(e){var t=this,n=(this.textBuffer+e).split(/\r?\n/);this.textBuffer=n.pop()||"",n.forEach((function(e){return t._addLine(e)}))}},{key:"_transform",value:function(e,t,n){this._nextText(this.decoder.write(e)),d(n)}},{key:"_flush",value:function(e){this.decoder.end&&this._nextText(this.decoder.end()),null!=this.textBuffer&&this._addLine(this.textBuffer),this.parser.finish(),d(e)}}]),n}(c.Transform);function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new p(e)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return[];var n=v(t),r=[],i=r.push.bind(r),a=new h.a({featureCallback:n.parseFeatures?i:void 0,directiveCallback:n.parseDirectives?i:void 0,commentCallback:n.parseComments?i:void 0,sequenceCallback:n.parseSequences?i:void 0,bufferSize:1/0,errorCallback:function(e){throw e}});return e.split(/\r?\n/).forEach(a.addLine.bind(a)),a.finish(),r}function g(e){var t=[],n=[];e.forEach((function(e){"sequence"in e?n.push(e):t.push(e)}));var r=t.map(l.formatItem).join("");return n.length&&(r+="##FASTA\n",r+=n.map(l.formatSequence).join("")),r}var y=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r.a)(this,n),(e=t.call(this,Object.assign(i,{objectMode:!0}))).linesSinceLastSyncMark=0,e.haveWeEmittedData=!1,e.fastaMode=!1,e.minLinesBetweenSyncMarks=i.minSyncLines||100,e.insertVersionDirective=i.insertVersionDirective||!1,e}return Object(i.a)(n,[{key:"_transform",value:function(e,t,n){var r;if(!this.haveWeEmittedData&&this.insertVersionDirective){var i=Array.isArray(e)?e[0]:e;"directive"in i&&"gff-version"!==i.directive&&this.push("##gff-version 3\n")}if("sequence"in e&&!this.fastaMode&&(this.push("##FASTA\n"),this.fastaMode=!0),r=Array.isArray(e)?e.map(l.formatItem).join(""):Object(l.formatItem)(e),this.push(r),this.linesSinceLastSyncMark>=this.minLinesBetweenSyncMarks)this.push("###\n"),this.linesSinceLastSyncMark=0;else{for(var a=0,s=0;s<r.length;s+=1)"\n"===r[s]&&(a+=1);this.linesSinceLastSyncMark+=a}this.haveWeEmittedData=!0,d(n)}}]),n}(c.Transform);function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new y(e)}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(u.a)({insertVersionDirective:!0},n);return new Promise((function(n,i){e.pipe(new y(r)).on("end",(function(){return n(null)})).on("error",i).pipe(t)}))}}).call(this,n(114))},1198:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(15),i=n(5),a=n(6),s=n(12),o=n(11),u=n(1006),c="child_features",f="derived_features",h=function(){function e(t){Object(s.a)(this,e),this.seqCallback=t,this.currentSequence=void 0}return Object(o.a)(e,[{key:"addLine",value:function(e){var t=/^>\s*(\S+)\s*(.*)/.exec(e);t?(this._flush(),this.currentSequence={id:t[1],sequence:""},t[2]&&(this.currentSequence.description=t[2].trim())):this.currentSequence&&/\S/.test(e)&&(this.currentSequence.sequence+=e.replace(/\s/g,""))}},{key:"_flush",value:function(){this.currentSequence&&this.seqCallback(this.currentSequence)}},{key:"finish",value:function(){this._flush()}}]),e}(),l=function(){function e(t){Object(s.a)(this,e),this.fastaParser=void 0,this.eof=!1,this.lineNumber=0,this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},this._underConstructionOrphans={};var n=function(){};this.featureCallback=t.featureCallback||n,this.endCallback=t.endCallback||n,this.commentCallback=t.commentCallback||n,this.errorCallback=t.errorCallback||n,this.directiveCallback=t.directiveCallback||n,this.sequenceCallback=t.sequenceCallback||n,this.bufferSize=void 0===t.bufferSize?1e3:t.bufferSize}return Object(o.a)(e,[{key:"addLine",value:function(e){if(this.fastaParser)this.fastaParser.addLine(e);else if(!this.eof)if(this.lineNumber+=1,/^\s*[^#\s>]/.test(e))this._bufferLine(e);else{var t=/^\s*(#+)(.*)/.exec(e);if(t){var n=Object(a.a)(t,2)[1],r=Object(a.a)(t,3)[2];if(3===n.length)this._emitAllUnderConstructionFeatures();else if(2===n.length){var i=u.parseDirective(e);i&&("FASTA"===i.directive?(this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new h(this.sequenceCallback)):this._emitItem(i))}else r=r.replace(/\s*/,""),this._emitItem({comment:r})}else if(/^\s*$/.test(e));else{if(!/^\s*>/.test(e)){var s=e.replace(/\r?\n?$/g,"");throw new Error("GFF3 parse error.  Cannot parse '".concat(s,"'."))}this._emitAllUnderConstructionFeatures(),this.eof=!0,this.fastaParser=new h(this.sequenceCallback),this.fastaParser.addLine(e)}}}},{key:"finish",value:function(){this._emitAllUnderConstructionFeatures(),this.fastaParser&&this.fastaParser.finish(),this.endCallback()}},{key:"_emitItem",value:function(e){Array.isArray(e)?this.featureCallback(e):"directive"in e?this.directiveCallback(e):"comment"in e&&this.commentCallback(e)}},{key:"_enforceBufferSizeLimit",value:function(){for(var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=function t(n){n&&Array.isArray(n)&&n[0].attributes&&n[0].attributes.ID&&n[0].attributes.ID[0]&&(n[0].attributes.ID.forEach((function(t){delete e._underConstructionById[t],delete e._completedReferences[t]})),n.forEach((function(e){e.child_features&&e.child_features.forEach((function(e){return t(e)})),e.derived_features&&e.derived_features.forEach((function(e){return t(e)}))})))};this._underConstructionTopLevel.length+t>this.bufferSize;){var r=this._underConstructionTopLevel.shift();r&&(this._emitItem(r),n(r))}}},{key:"_emitAllUnderConstructionFeatures",value:function(){if(this._underConstructionTopLevel.forEach(this._emitItem.bind(this)),this._underConstructionTopLevel=[],this._underConstructionById={},this._completedReferences={},Array.from(Object.values(this._underConstructionOrphans)).length)throw new Error("some features reference other features that do not exist in the file (or in the same '###' scope). ".concat(JSON.stringify(this._underConstructionOrphans)))}},{key:"_bufferLine",value:function(e){var t,n,r,a=this,s=u.parseFeature(e),o=Object(i.a)(Object(i.a)({},s),{},{child_features:[],derived_features:[]}),c=(null===(t=o.attributes)||void 0===t?void 0:t.ID)||[],f=(null===(n=o.attributes)||void 0===n?void 0:n.Parent)||[],h=(null===(r=o.attributes)||void 0===r?void 0:r.Derives_from)||[];if(c.length||f.length||h.length){var l=void 0;c.forEach((function(e){var t=a._underConstructionById[e];t?(t[t.length-1].type!==o.type&&a._parseError('multi-line feature "'.concat(e,'" has inconsistent types: "').concat(o.type,'", "').concat(t[t.length-1].type,'"')),t.push(o),l=t):(l=[o],a._enforceBufferSizeLimit(1),f.length||h.length||a._underConstructionTopLevel.push(l),a._underConstructionById[e]=l,a._resolveReferencesTo(l,e))})),this._resolveReferencesFrom(l||[o],{Parent:f,Derives_from:h},c)}else this._emitItem([o])}},{key:"_resolveReferencesTo",value:function(e,t){var n=this._underConstructionOrphans[t];n&&(e.forEach((function(e){var t;(t=e.child_features).push.apply(t,Object(r.a)(n.Parent))})),e.forEach((function(e){var t;(t=e.derived_features).push.apply(t,Object(r.a)(n.Derives_from))})),delete this._underConstructionOrphans[t])}},{key:"_parseError",value:function(e){this.eof=!0,this.errorCallback("".concat(this.lineNumber,": ").concat(e))}},{key:"_resolveReferencesFrom",value:function(e,t,n){var r=this;function i(e,t,n){var r=e[t];r||(r={},e[t]=r);var i=r[n]||!1;return r[n]=!0,i}t.Parent.forEach((function(t){var a=r._underConstructionById[t];if(a){var s=c;n.filter((function(e){return i(r._completedReferences,e,"Parent,".concat(t))})).length||a.forEach((function(t){t[s].push(e)}))}else{var o=r._underConstructionOrphans[t];o||(o={Parent:[],Derives_from:[]},r._underConstructionOrphans[t]=o),o.Parent.push(e)}})),t.Derives_from.forEach((function(t){var a=r._underConstructionById[t];if(a){var s=f;n.filter((function(e){return i(r._completedReferences,e,"Derives_from,".concat(t))})).length||a.forEach((function(t){t[s].push(e)}))}else{var o=r._underConstructionOrphans[t];o||(o={Parent:[],Derives_from:[]},r._underConstructionOrphans[t]=o),o.Derives_from.push(e)}}))}}]),e}()},1289:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return k}));var r=n(6),i=n(5),a=n(10),s=n(12),o=n(11),u=n(17),c=n(18),f=n(2),h=n.n(f),l=n(53),d=n(85),v=n(41),p=n(75),b=n(47),m=n(1047),g=n(1196),y=n(4),k=function(e){Object(u.a)(n,e);var t=Object(c.a)(n);function n(e,r,i){var a;Object(s.a)(this,n),(a=t.call(this,e,r,i)).gff=void 0,a.dontRedispatch=void 0;var o=Object(y.readConfObject)(e,"gffGzLocation"),u=Object(y.readConfObject)(e,["index","indexType"]),c=Object(y.readConfObject)(e,["index","location"]),f=Object(y.readConfObject)(e,"dontRedispatch");return a.dontRedispatch=f||["chromosome","contig","region"],a.gff=new m.TabixIndexedFile({filehandle:Object(v.openLocation)(o,a.pluginManager),csiFilehandle:"CSI"===u?Object(v.openLocation)(c,a.pluginManager):void 0,tbiFilehandle:"CSI"!==u?Object(v.openLocation)(c,a.pluginManager):void 0,chunkCacheSize:50*Math.pow(2,20),renameRefSeqs:function(e){return e}}),a}return Object(o.a)(n,[{key:"getRefNames",value:function(){var e=Object(a.a)(h.a.mark((function e(){var t,n=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",this.gff.getReferenceSequenceNames(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=Object(a.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.gff.getHeader());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(p.ObservableCreate)(function(){var r=Object(a.a)(h.a.mark((function r(i){var a;return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.gff.getMetadata();case 2:a=r.sent,t.getFeaturesHelper(e,n,a,i,!0);case 4:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),n.signal)}},{key:"getFeaturesHelper",value:function(){var e=Object(a.a)(h.a.mark((function e(t){var n,r,a,s,o,u,c,f,l,v=this,p=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]?p[1]:{},r=p.length>2?p[2]:void 0,a=p.length>3?p[3]:void 0,s=p.length>4?p[4]:void 0,o=p.length>5&&void 0!==p[5]?p[5]:t,e.prev=5,u=[],e.next=9,this.gff.getLines(t.refName,t.start,t.end,(function(e,t){u.push(v.parseLine(r.columnNumbers,e,t))}));case 9:if(!s||!u.length){e.next=16;break}if(c=1/0,f=-1/0,u.forEach((function(e){var t=e.fields[2];if(!v.dontRedispatch.includes(t)){var n=e.start-1;n<c&&(c=n),e.end>f&&(f=e.end)}})),!(f>t.end||c<t.start)){e.next=16;break}return this.getFeaturesHelper(Object(i.a)(Object(i.a)({},t),{},{start:c,end:f}),n,r,a,!1,t),e.abrupt("return");case 16:l=u.map((function(e){return e.fields[8]&&"."!==e.fields[8]?e.fields[8].includes("_lineHash")||(e.fields[8]+=";_lineHash=".concat(e.lineHash)):e.fields[8]="_lineHash=".concat(e.lineHash),e.fields.join("\t")})).join("\n"),g.a.parseStringSync(l,{parseFeatures:!0,parseComments:!1,parseDirectives:!1,parseSequences:!1}).forEach((function(e){return v.formatFeatures(e).forEach((function(e){Object(d.a)(e.get("start"),e.get("end"),o.start,o.end)&&a.next(e)}))})),a.complete(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),a.error(e.t0);case 25:case"end":return e.stop()}}),e,this,[[5,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"parseLine",value:function(e,t,n){var r=t.split("\t");return{start:+r[e.start-1],end:+r[e.end-1],lineHash:n,fields:r}}},{key:"formatFeatures",value:function(e){var t=this;return e.map((function(e){return new b.a({data:t.featureData(e),id:"".concat(t.id,"-offset-").concat(e.attributes._lineHash[0])})}))}},{key:"featureData",value:function(e){var t=this,n=Object(i.a)({},e);n.start-=1,"+"===e.strand?n.strand=1:"-"===e.strand?n.strand=-1:"."===e.strand?n.strand=0:n.strand=void 0,n.phase=Number(e.phase),n.refName=e.seq_id,null===e.score&&delete n.score,null===e.phase&&delete n.score;var a=["start","end","seq_id","score","type","source","phase","strand"],s=e.attributes||{};return Object.keys(s).forEach((function(e){var t=e.toLowerCase();if(a.includes(t)&&(t+="2"),null!==s[e]){var i=s[e];if(Array.isArray(i)&&1===i.length){var o=i;i=Object(r.a)(o,1)[0]}n[t]=i}})),n.refName=n.seq_id,e.child_features&&e.child_features.length&&(n.subfeatures=e.child_features.map((function(e){return e.map((function(e){return t.featureData(e)}))})).flat()),delete n.child_features,delete n.data,delete n.derived_features,delete n._linehash,delete n.attributes,delete n.seq_id,n}},{key:"freeResources",value:function(){}}]),n}(l.BaseFeatureDataAdapter)},913:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.AbortSignal=t.AbortController=void 0;var r=n(333),i=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;throw new Error("unable to locate global object")},a="undefined"===typeof i().AbortController?r.AbortController:i().AbortController;t.AbortController=a;var s="undefined"===typeof i().AbortController?r.AbortSignal:i().AbortSignal;t.AbortSignal=s}).call(this,n(70))},914:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(918));t.default=i.default},915:function(e,t){e.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(E){}function r(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function i(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var a={},s={};function o(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=s[e])?r:(n=c(e,(0|e)<0?-1:0,!0),i&&(s[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=c(e,e<0?-1:0,!1),i&&(a[e]=n),n)}function u(e,t){if(isNaN(e))return t?g:m;if(t){if(e<0)return g;if(e>=v)return _}else{if(e<=-p)return S;if(e+1>=p)return x}return e<0?u(-e,t).neg():c(e%d|0,e/d|0,t)}function c(e,t,n){return new r(e,t,n)}r.fromInt=o,r.fromNumber=u,r.fromBits=c;var f=Math.pow;function h(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return m;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return h(e.substring(1),t,n).neg();for(var i=u(f(n,8)),a=m,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+o),n);if(o<8){var l=u(f(n,o));a=a.mul(l).add(u(c))}else a=(a=a.mul(i)).add(u(c))}return a.unsigned=t,a}function l(e,t){return"number"===typeof e?u(e,t):"string"===typeof e?h(e,t):c(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}r.fromString=h,r.fromValue=l;var d=4294967296,v=d*d,p=v/2,b=o(1<<24),m=o(0);r.ZERO=m;var g=o(0,!0);r.UZERO=g;var y=o(1);r.ONE=y;var k=o(1,!0);r.UONE=k;var w=o(-1);r.NEG_ONE=w;var x=c(-1,2147483647,!1);r.MAX_VALUE=x;var _=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var S=c(0,-2147483648,!1);r.MIN_VALUE=S;var C=r.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=u(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=u(f(e,6),this.unsigned),a=this,s="";;){var o=a.div(i),c=(a.sub(o.mul(i)).toInt()>>>0).toString(e);if((a=o).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1===(1&this.low)},C.isEven=function(){return 0===(1&this.low)},C.equals=function(e){return i(e)||(e=l(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(i(e)||(e=l(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(y)},C.neg=C.negate,C.add=function(e){i(e)||(e=l(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,a=65535&this.low,s=e.high>>>16,o=65535&e.high,u=e.low>>>16,f=0,h=0,d=0,v=0;return d+=(v+=a+(65535&e.low))>>>16,h+=(d+=r+u)>>>16,f+=(h+=n+o)>>>16,f+=t+s,c((d&=65535)<<16|(v&=65535),(f&=65535)<<16|(h&=65535),this.unsigned)},C.subtract=function(e){return i(e)||(e=l(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return m;if(i(e)||(e=l(e)),n)return c(n.mul(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned);if(e.isZero())return m;if(this.eq(S))return e.isOdd()?S:m;if(e.eq(S))return this.isOdd()?S:m;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(b)&&e.lt(b))return u(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,a=this.low>>>16,s=65535&this.low,o=e.high>>>16,f=65535&e.high,h=e.low>>>16,d=65535&e.low,v=0,p=0,g=0,y=0;return g+=(y+=s*d)>>>16,p+=(g+=a*d)>>>16,g&=65535,p+=(g+=s*h)>>>16,v+=(p+=r*d)>>>16,p&=65535,v+=(p+=a*h)>>>16,p&=65535,v+=(p+=s*f)>>>16,v+=t*d+r*h+a*f+s*o,c((g&=65535)<<16|(y&=65535),(v&=65535)<<16|(p&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(i(e)||(e=l(e)),e.isZero())throw Error("division by zero");var t,r,a;if(n)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:m;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return k;a=g}else{if(this.eq(S))return e.eq(y)||e.eq(w)?S:e.eq(S)?y:(t=this.shr(1).div(e).shl(1)).eq(m)?e.isNegative()?y:w:(r=this.sub(e.mul(t)),a=t.add(r.div(e)));if(e.eq(S))return this.unsigned?g:m;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=m}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(t)/Math.LN2),o=s<=48?1:f(2,s-48),h=u(t),d=h.mul(e);d.isNegative()||d.gt(r);)d=(h=u(t-=o,this.unsigned)).mul(e);h.isZero()&&(h=y),a=a.add(h),r=r.sub(d)}return a},C.div=C.divide,C.modulo=function(e){return i(e)||(e=l(e)),n?c((this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high),n.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return c(~this.low,~this.high,this.unsigned)},C.and=function(e){return i(e)||(e=l(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return i(e)||(e=l(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return i(e)||(e=l(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return i(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?c(this.low>>>e|t<<32-e,t>>>e,this.unsigned):c(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},918:function(e,t,n){"use strict";var r=n(111).default,i=n(112).default,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(913),o=a(n(919)),u=a(n(920)),c=function(){function e(t){var n=t.fill,i=t.cache;if(r(this,e),"function"!==typeof n)throw new TypeError("must pass a fill function");if("object"!==typeof i)throw new TypeError("must pass a cache object");if("function"!==typeof i.get||"function"!==typeof i.set||"function"!==typeof i.delete)throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=i,this.fillCallback=n}return i(e,[{key:"evict",value:function(e,t){this.cache.get(e)===t&&this.cache.delete(e)}},{key:"fill",value:function(e,t,n,r){var i=this,a=new o.default,s=new u.default;s.addCallback(r);var c={aborter:a,promise:this.fillCallback(t,a.signal,(function(e){s.callback(e)})),settled:!1,statusReporter:s,get aborted(){return this.aborter.signal.aborted}};c.aborter.addSignal(n),c.aborter.signal.addEventListener("abort",(function(){c.settled||i.evict(e,c)})),c.promise.then((function(){c.settled=!0}),(function(){c.settled=!0,i.evict(e,c)})).catch((function(e){throw console.error(e),e})),this.cache.set(e,c)}},{key:"has",value:function(e){return this.cache.has(e)}},{key:"get",value:function(t,n,r,i){if(!r&&n instanceof s.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");var a=this.cache.get(t);return a?a.aborted&&!a.settled?(this.evict(t,a),this.get(t,n,r,i)):a.settled?a.promise:(a.aborter.addSignal(r),a.statusReporter.addCallback(i),e.checkSinglePromise(a.promise,r)):(this.fill(t,n,r,i),e.checkSinglePromise(this.cache.get(t).promise,r))}},{key:"delete",value:function(e){var t=this.cache.get(e);t&&(t.settled||t.aborter.abort(),this.cache.delete(e))}},{key:"clear",value:function(){for(var e=this.cache.keys(),t=0,n=e.next();!n.done;n=e.next())this.delete(n.value),t+=1;return t}}],[{key:"isAbortException",value:function(e){return"AbortError"===e.name||"ERR_ABORTED"===e.code||"AbortError: aborted"===e.message||"Error: aborted"===e.message}},{key:"checkSinglePromise",value:function(e,t){function n(){if(t&&t.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return e.then((function(e){return n(),e}),(function(e){throw n(),e}))}}]),e}();t.default=c},919:function(e,t,n){"use strict";var r=n(112).default,i=n(111).default;Object.defineProperty(t,"__esModule",{value:!0});var a=n(913),s=r((function e(){i(this,e)})),o=function(){function e(){i(this,e),this.signals=new Set,this.abortController=new a.AbortController}return r(e,[{key:"addSignal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s;if(this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):"function"===typeof t.addEventListener&&t.addEventListener("abort",(function(){e.handleAborted(t)}))}},{key:"handleAborted",value:function(e){this.signals.delete(e),0===this.signals.size&&this.abortController.abort()}},{key:"signal",get:function(){return this.abortController.signal}},{key:"abort",value:function(){this.abortController.abort()}}]),e}();t.default=o},920:function(e,t,n){"use strict";var r=n(111).default,i=n(112).default;Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e),this.callbacks=new Set}return i(e,[{key:"addCallback",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.callbacks.add(e),e(this.currentMessage)}},{key:"callback",value:function(e){this.currentMessage=e,this.callbacks.forEach((function(t){t(e)}))}}]),e}();t.default=a},923:function(e,t,n){"use strict";var r=n(2),i=n(247).default,a=n(410).default,s=n(111).default,o=n(112).default,u=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(s(this,t),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.cache=new Map,this.oldCache=new Map,this._size=0}return o(t,[{key:"_set",value:function(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this.oldCache=this.cache,this.cache=new Map)}},{key:"get",value:function(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){var t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}},{key:"set",value:function(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}},{key:"has",value:function(e){return this.cache.has(e)||this.oldCache.has(e)}},{key:"peek",value:function(e){return this.cache.has(e)?this.cache.get(e):this.oldCache.has(e)?this.oldCache.get(e):void 0}},{key:"delete",value:function(e){var t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}},{key:"clear",value:function(){this.cache.clear(),this.oldCache.clear(),this._size=0}},{key:"keys",value:r.mark((function e(){var t,n,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return s=i(n.value,1),o=s[0],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"values",value:r.mark((function e(){var t,n,s,o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return s=i(n.value,2),o=s[1],e.next=7,o;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:e,value:r.mark((function e(){var t,n,s,o,u,c,f,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a(this.cache),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return s=n.value,e.next=7,s;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:o=a(this.oldCache),e.prev=18,o.s();case 20:if((u=o.n()).done){e.next=28;break}if(c=u.value,f=i(c,1),h=f[0],this.cache.has(h)){e.next=26;break}return e.next=26,c;case 26:e.next=20;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(18),o.e(e.t1);case 33:return e.prev=33,o.f(),e.finish(33);case 36:case"end":return e.stop()}}),e,this,[[1,11,14,17],[18,30,33,36]])}))},{key:"size",get:function(){var e,t=0,n=a(this.oldCache.keys());try{for(n.s();!(e=n.n()).done;){var r=e.value;this.cache.has(r)||t++}}catch(i){n.e(i)}finally{n.f()}return this._size+t}}]),t}(Symbol.iterator);e.exports=u},940:function(e,t,n){"use strict";var r=n(2),i=n(653).default,a=n(112).default,s=n(111).default,o=n(405).default,u=n(408).default,c=n(656).default;Object.defineProperty(t,"__esModule",{value:!0}),t.optimizeChunks=t.canMergeBlocks=t.abortBreakPoint=t.checkAbortSignal=t.longToNumber=void 0,t.longToNumber=function(e){if(e.greaterThan(Number.MAX_SAFE_INTEGER)||e.lessThan(Number.MIN_SAFE_INTEGER))throw new Error("integer overflow");return e.toNumber()};var f=function(e){o(n,e);var t=u(n);function n(){return s(this,n),t.apply(this,arguments)}return a(n)}(c(Error));function h(e){if(e&&e.aborted){if("undefined"!==typeof DOMException)throw new DOMException("aborted","AbortError");var t=new f("aborted");throw t.code="ERR_ABORTED",t}}function l(){return(l=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:h(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e,t){return t.minv.blockPosition-e.maxv.blockPosition<65e3&&t.maxv.blockPosition-e.minv.blockPosition<5e6}t.checkAbortSignal=h,t.abortBreakPoint=function(e){return l.apply(this,arguments)},t.canMergeBlocks=d,t.optimizeChunks=function(e,t){var n=[],r=null;return 0===e.length?e:(e.sort((function(e,t){var n=e.minv.blockPosition-t.minv.blockPosition;return 0!==n?n:e.minv.dataPosition-t.minv.dataPosition})),e.forEach((function(e){(!t||e.maxv.compareTo(t)>0)&&(null===r?(n.push(e),r=e):d(r,e)?e.maxv.compareTo(r.maxv)>0&&(r.maxv=e.maxv):(n.push(e),r=e))})),n)}},943:function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i},e.exports.__esModule=!0,e.exports.default=e.exports},967:function(e,t,n){"use strict";var r=n(247).default,i=n(410).default,a=n(2),s=n(653).default,o=n(111).default,u=n(112).default,c=n(405).default,f=n(408).default,h=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),d=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&h(t,e,n);return l(t,e),t},v=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var p=v(n(915)),b=d(n(968)),m=v(n(969)),g=n(120),y=n(940),k=v(n(970)),w=21578324;function x(e,t){return[[0,0],[1+((e+=1)>>26),1+((t-=1)>>26)],[9+(e>>23),9+(t>>23)],[73+(e>>20),73+(t>>20)],[585+(e>>17),585+(t>>17)],[4681+(e>>14),4681+(t>>14)]]}var _=function(e){c(n,e);var t=f(n);function n(){return o(this,n),t.apply(this,arguments)}return u(n,[{key:"lineCount",value:function(){var e=s(a.mark((function e(t){var n,r,i,s,o=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},e.next=3,this.parse(n);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(i=r.refNameToId[t],r.indices[i]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(s=r.indices[i].stats)){e.next=13;break}return e.abrupt("return",s.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parse",value:function(){var e=s(a.mark((function e(){var t,n,r,i,s,o,u,c,f,h,l,d,v,p,k,x,_,S,C,E,O=this,I=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=I.length>0&&void 0!==I[0]?I[0]:{},e.t0=g.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if(n=e.sent,(0,y.checkAbortSignal)(t.signal),n.readUInt32LE(0)===w){e.next=11;break}throw new Error("Not a TBI file");case 11:if(r=n.readInt32LE(4),i=n.readInt32LE(8),s=65536&i?"zero-based-half-open":"1-based-closed",o={0:"generic",1:"SAM",2:"VCF"}[15&i]){e.next=18;break}throw new Error("invalid Tabix preset format flags ".concat(i));case 18:return u={ref:n.readInt32LE(12),start:n.readInt32LE(16),end:n.readInt32LE(20)},c=n.readInt32LE(24),h=((1<<3*((f=5)+1))-1)/7,l=Math.pow(2,14+3*f),d=c?String.fromCharCode(c):null,v=n.readInt32LE(28),p=n.readInt32LE(32),k=this._parseNameBytes(n.slice(36,36+p)),x=k.refNameToId,_=k.refIdToName,S=36+p,E=new Array(r).fill(0).map((function(){var e=n.readInt32LE(S);S+=4;for(var t,r={},i=0;i<e;i+=1){var a=n.readUInt32LE(S);if(S+=4,a>h+1)throw new Error("tabix index contains too many bins, please use a CSI index");if(a===h+1){var s=n.readInt32LE(S);S+=4,2===s&&(t=O.parsePseudoBin(n,S)),S+=16*s}else{var o=n.readInt32LE(S);S+=4;for(var u=new Array(o),c=0;c<o;c+=1){var f=(0,b.fromBytes)(n,S),l=(0,b.fromBytes)(n,S+8);S+=16,C=O._findFirstData(C,f),u[c]=new m.default(f,l,a)}r[a]=u}}var d=n.readInt32LE(S);S+=4;for(var v=new Array(d),p=0;p<d;p+=1)v[p]=(0,b.fromBytes)(n,S),S+=8,C=O._findFirstData(C,v[p]);return{binIndex:r,linearIndex:v,stats:t}})),e.abrupt("return",{indices:E,metaChar:d,maxBinNumber:h,maxRefLength:l,skipLines:v,firstDataLine:C,columnNumbers:u,coordinateType:s,format:o,refIdToName:_,refNameToId:x,maxBlockSize:65536});case 30:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:(0,y.longToNumber)(p.default.fromBytesLE(e.slice(t+16,t+24),!0))}}},{key:"_parseNameBytes",value:function(e){for(var t=0,n=0,r=[],i={},a=0;a<e.length;a+=1)if(!e[a]){if(n<a){var s=e.toString("utf8",n,a);s=this.renameRefSeq(s),r[t]=s,i[s]=t}n=a+1,t+=1}return{refNameToId:i,refIdToName:r}}},{key:"blocksForRange",value:function(){var e=s(a.mark((function e(t,n,s){var o,u,c,f,h,l,d,v,p,g,k,w,_,S,C,E,O,I,L,j,T=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=T.length>3&&void 0!==T[3]?T[3]:{},n<0&&(n=0),e.next=4,this.parse(o);case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(c=u.refNameToId[t],f=u.indices[c]){e.next=11;break}return e.abrupt("return",[]);case 11:(f.linearIndex.length?f.linearIndex[n>>14>=f.linearIndex.length?f.linearIndex.length-1:n>>14]:new b.default(0,0))||console.warn("querying outside of possible tabix range"),h=x(n,s),l=[],d=i(h);try{for(d.s();!(v=d.n()).done;)for(p=r(v.value,2),g=p[0],k=p[1],w=g;w<=k;w++)if(f.binIndex[w])for(_=f.binIndex[w],S=0;S<_.length;++S)l.push(new m.default(_[S].minv,_[S].maxv,w))}catch(a){d.e(a)}finally{d.f()}for(C=f.linearIndex.length,E=null,O=Math.min(n>>14,C-1),I=Math.min(s>>14,C-1),L=O;L<=I;++L)(j=f.linearIndex[L])&&(!E||j.compareTo(E)<0)&&(E=j);return e.abrupt("return",(0,y.optimizeChunks)(l,E));case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}]),n}(k.default);t.default=_},968:function(e,t,n){"use strict";var r=n(111).default,i=n(112).default;Object.defineProperty(t,"__esModule",{value:!0}),t.fromBytes=void 0;var a=function(){function e(t,n){r(this,e),this.blockPosition=t,this.dataPosition=n}return i(e,[{key:"toString",value:function(){return"".concat(this.blockPosition,":").concat(this.dataPosition)}},{key:"compareTo",value:function(e){return this.blockPosition-e.blockPosition||this.dataPosition-e.dataPosition}}],[{key:"min",value:function(){for(var e,t=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(;!e;t+=1)e=r[t];for(;t<r.length;t+=1)e.compareTo(r[t])>0&&(e=r[t]);return e}}]),e}();t.default=a,t.fromBytes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n)throw new Error("big-endian virtual file offsets not implemented");return new a(1099511627776*e[t+7]+4294967296*e[t+6]+16777216*e[t+5]+65536*e[t+4]+256*e[t+3]+e[t+2],e[t+1]<<8|e[t])}},969:function(e,t,n){"use strict";var r=n(111).default,i=n(112).default;Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;r(this,e),this.minv=t,this.maxv=n,this.bin=i,this._fetchedSize=a}return i(e,[{key:"toUniqueString",value:function(){return"".concat(this.minv,"..").concat(this.maxv," (bin ").concat(this.bin,", fetchedSize ").concat(this.fetchedSize(),")")}},{key:"toString",value:function(){return this.toUniqueString()}},{key:"compareTo",value:function(e){return this.minv.compareTo(e.minv)||this.maxv.compareTo(e.maxv)||this.bin-e.bin}},{key:"fetchedSize",value:function(){return void 0!==this._fetchedSize?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}}]),e}();t.default=a},970:function(e,t,n){"use strict";var r=n(2),i=n(1003).default,a=n(653).default,s=n(111).default,o=n(112).default,u=["indices"],c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=c(n(914)),h=c(n(923)),l=function(){function e(t){var n=t.filehandle,r=t.renameRefSeqs,i=void 0===r?function(e){return e}:r;s(this,e),this.filehandle=n,this.renameRefSeq=i}return o(e,[{key:"getMetadata",value:function(){var e=a(r.mark((function e(){var t,n,a,s=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},e.next=3,this.parse(t);case 3:return n=e.sent,n.indices,a=i(n,u),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_findFirstData",value:function(e,t){return e?e.compareTo(t)>0?t:e:t}},{key:"parse",value:function(){var e=a(r.mark((function e(){var t,n=this,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},this._parseCache||(this._parseCache=new f.default({cache:new h.default({maxSize:1}),fill:function(){return n._parse(t)}})),e.abrupt("return",this._parseCache.get("index",null,void 0));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasRefSeq",value:function(){var e=a(r.mark((function e(t){var n,i=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.parse(n);case 3:if(e.t1=t,e.t0=e.sent.indices[e.t1],e.t0){e.next=7;break}e.t0={};case 7:return e.abrupt("return",!!e.t0.binIndex);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=l},971:function(e,t,n){"use strict";var r=n(247).default,i=n(410).default,a=n(657).default,s=n(2),o=n(653).default,u=n(111).default,c=n(112).default,f=n(405).default,h=n(408).default,l=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),v=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&l(t,e,n);return d(t,e),t},p=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var b=p(n(915)),m=n(120),g=v(n(968)),y=p(n(969)),k=n(940),w=p(n(970)),x=21582659,_=38359875;function S(e,t){return Math.floor(e/Math.pow(2,t))}var C=function(e){f(n,e);var t=h(n);function n(e){var r;return u(this,n),(r=t.call(this,e)).maxBinNumber=0,r.depth=0,r.minShift=0,r}return c(n,[{key:"lineCount",value:function(){var e=o(s.mark((function e(t){var n,r,i,a,o=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:{},e.next=3,this.parse(n);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",-1);case 6:if(i=r.refNameToId[t],r.indices[i]){e.next=10;break}return e.abrupt("return",-1);case 10:if(!(a=r.indices[i].stats)){e.next=13;break}return e.abrupt("return",a.lineCount);case 13:return e.abrupt("return",-1);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"indexCov",value:function(){var e=o(s.mark((function e(){return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("CSI indexes do not support indexcov");case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"parseAuxData",value:function(e,t,n){if(n<30)return{refIdToName:[],refNameToId:{}};var r=e.readInt32LE(t),i=65536&r?"zero-based-half-open":"1-based-closed",a={0:"generic",1:"SAM",2:"VCF"}[15&r];if(!a)throw new Error("invalid Tabix preset format flags ".concat(r));var s={ref:e.readInt32LE(t+4),start:e.readInt32LE(t+8),end:e.readInt32LE(t+12)},o=e.readInt32LE(t+16),u=o?String.fromCharCode(o):"",c=e.readInt32LE(t+20),f=e.readInt32LE(t+24),h=this._parseNameBytes(e.slice(t+28,t+28+f));return{refIdToName:h.refIdToName,refNameToId:h.refNameToId,skipLines:c,metaChar:u,columnNumbers:s,format:a,coordinateType:i}}},{key:"_parseNameBytes",value:function(e){for(var t=0,n=0,r=[],i={},a=0;a<e.length;a+=1)if(!e[a]){if(n<a){var s=e.toString("utf8",n,a);s=this.renameRefSeq(s),r[t]=s,i[s]=t}n=a+1,t+=1}return{refNameToId:i,refIdToName:r}}},{key:"_parse",value:function(){var e=o(s.mark((function e(){var t,n,r,i,o,u,c,f,h,l,d=this,v=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:{},e.t0=m.unzip,e.next=4,this.filehandle.readFile(t);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:if((n=e.sent).readUInt32LE(0)!==x){e.next=12;break}r=1,e.next=17;break;case 12:if(n.readUInt32LE(0)!==_){e.next=16;break}r=2,e.next=17;break;case 16:throw new Error("Not a CSI file");case 17:return this.minShift=n.readInt32LE(4),this.depth=n.readInt32LE(8),this.maxBinNumber=((1<<3*(this.depth+1))-1)/7,i=Math.pow(2,this.minShift+3*this.depth),o=n.readInt32LE(12),u={refIdToName:[],refNameToId:{}},o&&(u=this.parseAuxData(n,16,o)),c=n.readInt32LE(16+o),h=16+o+4,l=new Array(c).fill(0).map((function(){var e=n.readInt32LE(h);h+=4;for(var t,r={},i=0;i<e;i+=1){var a=n.readUInt32LE(h);if(a>d.maxBinNumber)t=d.parsePseudoBin(n,h+4),h+=48;else{var s=(0,g.fromBytes)(n,h+4);f=d._findFirstData(f,s);var o=n.readInt32LE(h+12);h+=16;for(var u=new Array(o),c=0;c<o;c+=1){var l=(0,g.fromBytes)(n,h),v=(0,g.fromBytes)(n,h+8);h+=16,u[c]=new y.default(l,v,a)}r[a]=u}}return{binIndex:r,stats:t}})),e.abrupt("return",a(a({},u),{},{csi:!0,refCount:c,maxBlockSize:65536,firstDataLine:f,csiVersion:r,indices:l,depth:this.depth,maxBinNumber:this.maxBinNumber,maxRefLength:i}));case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(e,t){return{lineCount:(0,k.longToNumber)(b.default.fromBytesLE(Array.prototype.slice.call(e,t+28,t+36),!0))}}},{key:"blocksForRange",value:function(){var e=o(s.mark((function e(t,n,a){var o,u,c,f,h,l,d,v,p,b,m,w,x,_,S=arguments;return s.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=S.length>3&&void 0!==S[3]?S[3]:{},n<0&&(n=0),e.next=4,this.parse(o);case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return",[]);case 7:if(c=u.refNameToId[t],f=u.indices[c]){e.next=11;break}return e.abrupt("return",[]);case 11:h=this.reg2bins(n,a),l=[],d=i(h);try{for(d.s();!(v=d.n()).done;)for(p=r(v.value,2),b=p[0],m=p[1],w=b;w<=m;w++)if(f.binIndex[w])for(x=f.binIndex[w],_=0;_<x.length;++_)l.push(new y.default(x[_].minv,x[_].maxv,w))}catch(s){d.e(s)}finally{d.f()}return e.abrupt("return",(0,k.optimizeChunks)(l,new g.default(0,0)));case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"reg2bins",value:function(e,t){(e-=1)<1&&(e=1),t>Math.pow(2,50)&&(t=Math.pow(2,34)),t-=1;for(var n,r=0,i=0,a=this.minShift+3*this.depth,s=[];r<=this.depth;a-=3,i+=(n=3*r,1*Math.pow(2,n)),r+=1){var o=i+S(e,a),u=i+S(t,a);if(u-o+s.length>this.maxBinNumber)throw new Error("query ".concat(e,"-").concat(t," is too large for current binning scheme (shift ").concat(this.minShift,", depth ").concat(this.depth,"), try a smaller query or a coarser index binning scheme"));s.push([o,u])}return s}}]),n}(w.default);t.default=C}});
//# sourceMappingURL=9.aa3f117980c15500c977.worker.js.map