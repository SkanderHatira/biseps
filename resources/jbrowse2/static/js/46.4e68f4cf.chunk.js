(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[46],{1717:function(e,n,t){"use strict";t.r(n);var a=t(29),o=t(86),r=t(80),c=t.n(r),l=t(1),i=t.n(l),s=t(51),d=t(1636),u=t(1634),m=t(1650),f=t(1745),b=t(1640),g=t(1663),h=t(1261),v=t(1631),C=t(1643),k=t(1683),E=t(345),p=t.n(E),j=t(237),O=t.n(j),y=t(441),x=t.n(y),w=t(822),T=t.n(w),W=t(827),I=t.n(W),S=t(1572),N=t.n(S),A=t(177),B=t(1571),L=t(233),M=t(83),D=t(79),H=t(84),F=t(1603),P=Object(l.lazy)((function(){return t.e(61).then(t.bind(null,1598))})),z=Object(l.lazy)((function(){return t.e(62).then(t.bind(null,1599))})),R=Object(l.lazy)((function(){return t.e(63).then(t.bind(null,1600))})),J=Object(l.lazy)((function(){return t.e(64).then(t.bind(null,1601))})),U=Object(s.a)((function(e){var n,t;return{searchBox:{margin:e.spacing(2)},menuIcon:{marginRight:e.spacing(1),marginBottom:0},fab:{position:"absolute",bottom:e.spacing(6),right:e.spacing(6)},compactCheckbox:{padding:0},checkboxLabel:{marginRight:0,"&:hover":{backgroundColor:"#eee"}},accordionBase:{display:"flex"},accordionCard:{padding:3,cursor:"pointer",display:"flex"},nestingLevelMarker:{position:"absolute",borderLeft:"1.5px solid #555"},accordionColor:{background:null===(n=e.palette.tertiary)||void 0===n?void 0:n.main,color:null===(t=e.palette.tertiary)||void 0===t?void 0:t.contrastText,width:"100%",display:"flex",paddingLeft:5},accordionText:{margin:"auto 0"}}})),_=function(e){var n=e.data,t=e.isOpen,a=e.style,o=e.setOpen,r=n.isLeaf,c=n.nestingLevel,l=n.checked,s=n.id,g=n.name,h=n.onChange,v=n.toggleCollapse,C=n.conf,k=n.onMoreInfo,E=n.drawerPosition,p=U(),j=10*c+(r?10:0),O=g&&(g.endsWith("(Unsupported)")||g.endsWith("(Unknown)")),y=C&&Object(D.readConfObject)(C,["description"])||"";return i.a.createElement("div",{style:a,className:r?void 0:p.accordionBase},new Array(c).fill(0).map((function(e,n){return i.a.createElement("div",{key:"mark-".concat(n),style:{left:10*n+4,height:a.height},className:p.nestingLevelMarker})})),i.a.createElement("div",{className:r?void 0:p.accordionCard,onClick:function(){v(s),o(!t)},style:{marginLeft:j,whiteSpace:"nowrap",width:"100%"}},i.a.createElement("div",{className:r?void 0:p.accordionColor},r?i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{title:y,placement:"left"===E?"right":"left"},i.a.createElement(m.a,{className:p.checkboxLabel,control:i.a.createElement(f.a,{className:p.compactCheckbox,checked:l,onChange:function(){return h(s)},color:"primary",disabled:O,inputProps:{"data-testid":"htsTrackEntry-".concat(s)}}),label:g})),i.a.createElement(b.a,{onClick:function(e){return k({target:e.currentTarget,id:s,conf:C})},color:"secondary","data-testid":"htsTrackEntryMenu-".concat(s)},i.a.createElement(N.a,null))):i.a.createElement("div",{className:p.accordionText},i.a.createElement(d.a,null,t?i.a.createElement(x.a,null):i.a.createElement(T.a,null),g)))))},q=function(e,n,t){var a=!!e.conf;return{data:Object(o.a)(Object(o.a)({defaultHeight:a?22:40,isLeaf:a,isOpenByDefault:!0,nestingLevel:n},e),t),nestingLevel:n,node:e}},G=Object(H.observer)((function(e){var n,t=e.height,o=e.tree,r=e.model,s=r.filterText,d=r.view,u=Object(l.useRef)(null),m=Object(l.useState)(),f=Object(a.a)(m,2),b=f[0],g=f[1],h=Object(M.getSession)(r),v=h.drawerPosition,C=Object(l.useMemo)((function(){return{onChange:function(e){return d.toggleTrack(e)},toggleCollapse:function(e){return r.toggleCategory(e)},onMoreInfo:g,drawerPosition:v}}),[d,r,v]),k=Object(l.useCallback)(c.a.mark((function e(){var n,t,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<o.children.length)){e.next=7;break}return e.next=4,q(o.children[n],0,C);case 4:n++,e.next=1;break;case 7:return void(e.next=10);case 10:t=e.sent,a=0;case 12:if(!(a<t.node.children.length)){e.next=19;break}return r=t.node.children[a],e.next=16,q(r,t.nestingLevel+1,C);case 16:a++,e.next=12;break;case 19:e.next=7;break;case 21:case"end":return e.stop()}}),e)})),[o,C]),E=null===b||void 0===b?void 0:b.conf,p=E&&(null===(n=h.getTrackActionMenuItems)||void 0===n?void 0:n.call(h,E))||[];return Object(l.useEffect)((function(){u.current.recomputeTree({refreshNodes:!0,useDefaultHeight:!0})}),[o,s]),i.a.createElement(i.a.Fragment,null,i.a.createElement(F.a,{ref:u,treeWalker:k,height:t},_),i.a.createElement(L.a,{anchorEl:null===b||void 0===b?void 0:b.target,menuItems:p,onMenuItemClick:function(e,n){n(),g(void 0)},open:Boolean(b),onClose:function(){return g(void 0)}}))})),K=function(e){var n=e.tree,t=e.model,a=e.offset;return"undefined"===typeof jest?i.a.createElement(B.a,{disableWidth:!0},(function(e){var o=e.height;return i.a.createElement(G,{height:o-a,model:t,tree:n})})):i.a.createElement(G,{height:9e3,model:t,tree:n})},Q=function(e){var n=e.overrideDimensions,t=e.children;return n?i.a.createElement("div",{style:Object(o.a)({},n)},t):i.a.createElement(i.a.Fragment,null,t)},V=Object(H.observer)((function(e){var n=e.model,t=e.toolbarHeight,o=e.overrideDimensions,r=U(),c=Object(M.getSession)(n),s=Object(l.useState)(null),d=Object(a.a)(s,2),u=d[0],m=d[1];function f(){m(null)}return i.a.createElement(Q,{overrideDimensions:o},i.a.createElement(Y,{model:n,toolbarHeight:t,overrideDimensions:o}),c.addConnectionConf||c.addTrackConf?i.a.createElement(i.a.Fragment,null,i.a.createElement(g.a,{color:"secondary",className:r.fab,onClick:function(e){m(e.currentTarget)}},i.a.createElement(O.a,null)),i.a.createElement(h.a,{anchorEl:u,open:Boolean(u),onClose:function(){return m(null)}},c.addConnectionConf?i.a.createElement(v.a,{onClick:function(){f();var e=c.addWidget("AddConnectionWidget","addConnectionWidget");c.showWidget(e)}},"Add connection"):null,c.addTrackConf?i.a.createElement(v.a,{onClick:function(){f();var e=c.addWidget("AddTrackWidget","addTrackWidget",{view:n.view.id});c.showWidget(e)}},"Add track"):null)):null)})),X=Object(H.observer)((function(e){var n=e.model,t=e.setHeaderHeight,o=e.setAssemblyIdx,r=e.assemblyIdx,c=U(),s=Object(M.getSession)(n),d=Object(l.useState)(),u=Object(a.a)(d,2),m=u[0],f=u[1],g=Object(l.useState)(),h=Object(a.a)(g,2),v=h[0],E=h[1],j=Object(l.useState)(),O=Object(a.a)(j,2),y=O[0],x=O[1],w=Object(l.useState)(),T=Object(a.a)(w,2),W=T[0],S=T[1],N=Object(l.useState)(!1),B=Object(a.a)(N,2),H=B[0],F=B[1],_=Object(l.useState)(!1),q=Object(a.a)(_,2),G=q[0],K=q[1],Q=n.assemblyNames,V=Q[r];function X(e,n){var t=Object(D.readConfObject)(e,"name"),o=s.prepareToBreakConnection(e);if(o){var r=Object(a.a)(o,2),c=r[0],l=r[1];Object.keys(l).length>0?x({connectionConf:e,safelyBreakConnection:c,dereferenceTypeCount:l,name:t}):c()}n&&S({name:t,connectionConf:e})}var Y=[{label:"Turn on/off connections...",onClick:function(){return K(!0)}}];s.addConnectionConf&&(Y.unshift({label:"Add connection",onClick:function(){s.showWidget(s.addWidget("AddConnectionWidget","addConnectionWidget"))}}),Y.push({label:"Delete connections...",onClick:function(){return F(!0)}}));var Z=Q.length>1?[{label:"Select assembly...",subMenu:Q.map((function(e,n){return{label:e,onClick:function(){o(n)}}}))}]:[],$=[{label:"Add track...",onClick:function(){s.showWidget(s.addWidget("AddTrackWidget","addTrackWidget",{view:n.view.id}))}}].concat(Z);return i.a.createElement("div",{ref:function(e){return t((null===e||void 0===e?void 0:e.getBoundingClientRect().height)||0)},"data-testid":"hierarchical_track_selector"},i.a.createElement("div",{style:{display:"flex"}},s.addTrackConf&&i.a.createElement(b.a,{className:c.menuIcon,onClick:function(e){E(e.currentTarget)}},i.a.createElement(I.a,null)),s.makeConnection&&i.a.createElement(b.a,{className:c.menuIcon,onClick:function(e){f(e.currentTarget)}},i.a.createElement(A.a,null)),i.a.createElement(C.a,{className:c.searchBox,label:"Filter tracks",value:n.filterText,onChange:function(e){return n.setFilterText(e.target.value)},fullWidth:!0,InputProps:{endAdornment:i.a.createElement(k.a,{position:"end"},i.a.createElement(b.a,{color:"secondary",onClick:n.clearFilterText},i.a.createElement(p.a,null)))}})),i.a.createElement(L.a,{anchorEl:m,open:Boolean(m),onMenuItemClick:function(e,n){n(),f(void 0)},onClose:function(){return f(void 0)},menuItems:Y}),i.a.createElement(L.a,{anchorEl:v,open:Boolean(v),onMenuItemClick:function(e,n){n(),E(void 0)},onClose:function(){return E(void 0)},menuItems:$}),i.a.createElement(l.Suspense,{fallback:i.a.createElement("div",null)},y?i.a.createElement(P,{modalInfo:y,setModalInfo:x,session:s}):W?i.a.createElement(z,{handleClose:function(){return S(void 0)},deleteDialogDetails:W,session:s}):null,H?i.a.createElement(R,{handleClose:function(){return F(!1)},breakConnection:X,session:s}):null,G?i.a.createElement(J,{handleClose:function(){return K(!1)},session:s,breakConnection:X,assemblyName:V}):null))})),Y=Object(H.observer)((function(e){var n=e.model,t=e.toolbarHeight,o=void 0===t?0:t,r=Object(l.useState)(0),c=Object(a.a)(r,2),s=c[0],d=c[1],u=Object(l.useState)(0),m=Object(a.a)(u,2),f=m[0],b=m[1],g=n.assemblyNames[s];return g?i.a.createElement(i.a.Fragment,null,i.a.createElement(X,{model:n,setHeaderHeight:b,setAssemblyIdx:d,assemblyIdx:s}),i.a.createElement(K,{tree:n.hierarchy(g),model:n,offset:o+f})):null}));n.default=V}}]);
//# sourceMappingURL=46.4e68f4cf.chunk.js.map