(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[37,84],{2536:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return x}));var n=r(83),i=r(87),a=r.n(i),o=r(91),l=r(90),s=r(94),u=r(96),h=r(97),c=r(160),f=r(134),v=r(187),p=r(82),m=r(991),_=r(227),k=r(456),y=r.n(k),d=r(1147),g=function(t){var e=t.split("\n"),r=[],n=[];return e.forEach((function(t){t.startsWith("#")?r.push(t):t&&n.push(t)})),{header:r.join("\n"),lines:n}};function w(t){return 31===t[0]&&139===t[1]&&8===t[2]}var x=function(t){Object(u.a)(r,t);var e=Object(h.a)(r);function r(){var t;Object(l.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(t=e.call.apply(e,[this].concat(i))).vcfFeatures=void 0,t}return Object(s.a)(r,[{key:"getHeader",value:function(){var t=Object(o.a)(a.a.mark((function t(){var e,r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setup();case 2:return e=t.sent,r=e.header,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getMetadata",value:function(){var t=Object(o.a)(a.a.mark((function t(){var e,r,n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setup();case 2:return e=t.sent,r=e.header,n=new y.a({header:r}),t.abrupt("return",n.getMetadata());case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setupP",value:function(){var t=Object(o.a)(a.a.mark((function t(){var e,r,i,o,l,s,u;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.openLocation)(Object(p.readConfObject)(this.config,"vcfLocation"),this.pluginManager).readFile();case 2:if(!w(e=t.sent)){t.next=9;break}return t.next=6,Object(_.unzip)(e);case 6:t.t0=t.sent,t.next=10;break;case 9:t.t0=e;case 10:if(!((r=t.t0).length>536870888)){t.next=13;break}throw new Error("Data exceeds maximum string length (512MB)");case 13:return i=(new TextDecoder).decode(r),o=g(i),l=o.header,s=o.lines,u=s.map((function(t,e){var r,i=t.split("\t"),a=Object(n.a)(i,8),o=a[0],l=a[1],s=a[3],u=+l-1;return{line:t,refName:o,start:u,end:+((null===(r=a[7].match(/END=(\d+)/))||void 0===r?void 0:r[1].trim())||u+s.length),id:e}})).reduce((function(t,e){var r=e.refName;return t[r]||(t[r]=new m.a),t[r].insert([e.start,e.end],e),t}),{}),t.abrupt("return",{header:l,intervalTree:u});case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setup",value:function(){var t=Object(o.a)(a.a.mark((function t(){var e=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.vcfFeatures||(this.vcfFeatures=this.setupP().catch((function(t){throw e.vcfFeatures=void 0,t}))),t.abrupt("return",this.vcfFeatures);case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getRefNames",value:function(){var t=Object(o.a)(a.a.mark((function t(){var e,r,n=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.length>0&&void 0!==n[0]?n[0]:{},t.next=3,this.setup();case 3:return e=t.sent,r=e.intervalTree,t.abrupt("return",Object.keys(r));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getFeatures",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(v.ObservableCreate)(function(){var r=Object(o.a)(a.a.mark((function r(n){var i,o,l,s,u,h,c,f;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,o=t.start,l=t.end,s=t.refName,r.next=4,e.setup();case 4:u=r.sent,h=u.header,c=u.intervalTree,f=new y.a({header:h}),null===(i=c[s])||void 0===i||i.search([o,l]).forEach((function(t){return n.next(new d.a({variant:f.parseLine(t.line),parser:f,id:"".concat(e.id,"-").concat(t.id)}))})),n.complete(),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(0),n.error(r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,12]])})));return function(t){return r.apply(this,arguments)}}(),r.signal)}},{key:"freeResources",value:function(){}}]),r}(c.BaseFeatureDataAdapter);x.capabilities=["getFeatures","getRefNames"]},392:function(t,e){},991:function(t,e,r){"use strict";var n=r(90),i=r(94),a=function(){function t(e,r){Object(n.a)(this,t),this.low=e,this.high=r}return Object(i.a)(t,[{key:"clone",value:function(){return new t(this.low,this.high)}},{key:"max",get:function(){return this.clone()}},{key:"less_than",value:function(t){return this.low<t.low||this.low==t.low&&this.high<t.high}},{key:"equal_to",value:function(t){return this.low==t.low&&this.high==t.high}},{key:"intersect",value:function(t){return!this.not_intersect(t)}},{key:"not_intersect",value:function(t){return this.high<t.low||t.high<this.low}},{key:"merge",value:function(e){return new t(void 0===this.low?e.low:Math.min(this.low,e.low),void 0===this.high?e.high:Math.max(this.high,e.high))}},{key:"output",value:function(){return[this.low,this.high]}}],[{key:"comparable_max",value:function(t,e){return t.merge(e)}},{key:"comparable_less_than",value:function(t,e){return t<e}}]),t}(),o=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(n.a)(this,t),this.left=i,this.right=o,this.parent=l,this.color=s,this.item={key:e,value:r},e&&e instanceof Array&&2==e.length&&(Number.isNaN(e[0])||Number.isNaN(e[1])||(this.item.key=new a(Math.min(e[0],e[1]),Math.max(e[0],e[1])))),this.max=this.item.key?this.item.key.max:void 0}return Object(i.a)(t,[{key:"isNil",value:function(){return void 0===this.item.key&&void 0===this.item.value&&null===this.left&&null===this.right&&1===this.color}},{key:"less_than",value:function(t){if(this.item.value===this.item.key&&t.item.value===t.item.key)return this.item.key.less_than(t.item.key);var e=this.item.value&&t.item.value&&this.item.value.less_than?this.item.value.less_than(t.item.value):this.item.value<t.item.value;return this.item.key.less_than(t.item.key)||this.item.key.equal_to(t.item.key)&&e}},{key:"equal_to",value:function(t){if(this.item.value===this.item.key&&t.item.value===t.item.key)return this.item.key.equal_to(t.item.key);var e=this.item.value&&t.item.value&&this.item.value.equal_to?this.item.value.equal_to(t.item.value):this.item.value==t.item.value;return this.item.key.equal_to(t.item.key)&&e}},{key:"intersect",value:function(t){return this.item.key.intersect(t.item.key)}},{key:"copy_data",value:function(t){this.item.key=t.item.key.clone(),this.item.value=t.item.value&&t.item.value.clone?t.item.value.clone():t.item.value}},{key:"update_max",value:function(){if(this.max=this.item.key?this.item.key.max:void 0,this.right&&this.right.max){var t=this.item.key.constructor.comparable_max;this.max=t(this.max,this.right.max)}if(this.left&&this.left.max){var e=this.item.key.constructor.comparable_max;this.max=e(this.max,this.left.max)}}},{key:"not_intersect_left_subtree",value:function(t){return(0,this.item.key.constructor.comparable_less_than)(void 0!==this.left.max.high?this.left.max.high:this.left.max,t.item.key.low)}},{key:"not_intersect_right_subtree",value:function(t){var e=this.item.key.constructor.comparable_less_than,r=void 0!==this.right.max.low?this.right.max.low:this.right.item.key.low;return e(t.item.key.high,r)}}]),t}(),l=function(){function t(){Object(n.a)(this,t),this.root=null,this.nil_node=new o}return Object(i.a)(t,[{key:"size",get:function(){var t=0;return this.tree_walk(this.root,(function(){return t++})),t}},{key:"keys",get:function(){var t=[];return this.tree_walk(this.root,(function(e){return t.push(e.item.key.output?e.item.key.output():e.item.key)})),t}},{key:"values",get:function(){var t=[];return this.tree_walk(this.root,(function(e){return t.push(e.item.value)})),t}},{key:"items",get:function(){var t=[];return this.tree_walk(this.root,(function(e){return t.push({key:e.item.key.output?e.item.key.output():e.item.key,value:e.item.value})})),t}},{key:"isEmpty",value:function(){return null==this.root||this.root==this.nil_node}},{key:"insert",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(void 0!==t){var r=new o(t,e,this.nil_node,this.nil_node,null,0);return this.tree_insert(r),this.recalc_max(r),r}}},{key:"exist",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=new o(t,e);return!!this.tree_search(this.root,r)}},{key:"remove",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=new o(t,e),n=this.tree_search(this.root,r);return n&&this.tree_delete(n),n}},{key:"search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t,e){return t===e?e.output():t},r=new o(t),n=[];return this.tree_search_interval(this.root,r,n),n.map((function(t){return e(t.item.value,t.item.key)}))}},{key:"intersect_any",value:function(t){var e=new o(t);return this.tree_find_any_interval(this.root,e)}},{key:"forEach",value:function(t){this.tree_walk(this.root,(function(e){return t(e.item.key,e.item.value)}))}},{key:"map",value:function(e){var r=new t;return this.tree_walk(this.root,(function(t){return r.insert(t.item.key,e(t.item.value,t.item.key))})),r}},{key:"recalc_max",value:function(t){for(var e=t;null!=e.parent;)e.parent.update_max(),e=e.parent}},{key:"tree_insert",value:function(t){var e=this.root,r=null;if(null==this.root||this.root==this.nil_node)this.root=t;else{for(;e!=this.nil_node;)r=e,e=t.less_than(e)?e.left:e.right;t.parent=r,t.less_than(r)?r.left=t:r.right=t}this.insert_fixup(t)}},{key:"insert_fixup",value:function(t){var e,r;for(e=t;e!=this.root&&0==e.parent.color;)e.parent==e.parent.parent.left?0==(r=e.parent.parent.right).color?(e.parent.color=1,r.color=1,e.parent.parent.color=0,e=e.parent.parent):(e==e.parent.right&&(e=e.parent,this.rotate_left(e)),e.parent.color=1,e.parent.parent.color=0,this.rotate_right(e.parent.parent)):0==(r=e.parent.parent.left).color?(e.parent.color=1,r.color=1,e.parent.parent.color=0,e=e.parent.parent):(e==e.parent.left&&(e=e.parent,this.rotate_right(e)),e.parent.color=1,e.parent.parent.color=0,this.rotate_left(e.parent.parent));this.root.color=1}},{key:"tree_delete",value:function(t){var e,r;(r=(e=t.left==this.nil_node||t.right==this.nil_node?t:this.tree_successor(t)).left!=this.nil_node?e.left:e.right).parent=e.parent,e==this.root?this.root=r:(e==e.parent.left?e.parent.left=r:e.parent.right=r,e.parent.update_max()),this.recalc_max(r),e!=t&&(t.copy_data(e),t.update_max(),this.recalc_max(t)),1==e.color&&this.delete_fixup(r)}},{key:"delete_fixup",value:function(t){for(var e,r=t;r!=this.root&&null!=r.parent&&1==r.color;)r==r.parent.left?(0==(e=r.parent.right).color&&(e.color=1,r.parent.color=0,this.rotate_left(r.parent),e=r.parent.right),1==e.left.color&&1==e.right.color?(e.color=0,r=r.parent):(1==e.right.color&&(e.color=0,e.left.color=1,this.rotate_right(e),e=r.parent.right),e.color=r.parent.color,r.parent.color=1,e.right.color=1,this.rotate_left(r.parent),r=this.root)):(0==(e=r.parent.left).color&&(e.color=1,r.parent.color=0,this.rotate_right(r.parent),e=r.parent.left),1==e.left.color&&1==e.right.color?(e.color=0,r=r.parent):(1==e.left.color&&(e.color=0,e.right.color=1,this.rotate_left(e),e=r.parent.left),e.color=r.parent.color,r.parent.color=1,e.left.color=1,this.rotate_right(r.parent),r=this.root));r.color=1}},{key:"tree_search",value:function(t,e){if(null!=t&&t!=this.nil_node)return e.equal_to(t)?t:e.less_than(t)?this.tree_search(t.left,e):this.tree_search(t.right,e)}},{key:"tree_search_interval",value:function(t,e,r){null!=t&&t!=this.nil_node&&(t.left==this.nil_node||t.not_intersect_left_subtree(e)||this.tree_search_interval(t.left,e,r),t.intersect(e)&&r.push(t),t.right==this.nil_node||t.not_intersect_right_subtree(e)||this.tree_search_interval(t.right,e,r))}},{key:"tree_find_any_interval",value:function(t,e){var r=!1;return null!=t&&t!=this.nil_node&&(t.left==this.nil_node||t.not_intersect_left_subtree(e)||(r=this.tree_find_any_interval(t.left,e)),r||(r=t.intersect(e)),r||t.right==this.nil_node||t.not_intersect_right_subtree(e)||(r=this.tree_find_any_interval(t.right,e))),r}},{key:"local_minimum",value:function(t){for(var e=t;null!=e.left&&e.left!=this.nil_node;)e=e.left;return e}},{key:"local_maximum",value:function(t){for(var e=t;null!=e.right&&e.right!=this.nil_node;)e=e.right;return e}},{key:"tree_successor",value:function(t){var e,r,n;if(t.right!=this.nil_node)e=this.local_minimum(t.right);else{for(r=t,n=t.parent;null!=n&&n.right==r;)r=n,n=n.parent;e=n}return e}},{key:"rotate_left",value:function(t){var e=t.right;t.right=e.left,e.left!=this.nil_node&&(e.left.parent=t),e.parent=t.parent,t==this.root?this.root=e:t==t.parent.left?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e,null!=t&&t!=this.nil_node&&t.update_max(),null!=(e=t.parent)&&e!=this.nil_node&&e.update_max()}},{key:"rotate_right",value:function(t){var e=t.left;t.left=e.right,e.right!=this.nil_node&&(e.right.parent=t),e.parent=t.parent,t==this.root?this.root=e:t==t.parent.left?t.parent.left=e:t.parent.right=e,e.right=t,t.parent=e,null!=t&&t!=this.nil_node&&t.update_max(),null!=(e=t.parent)&&e!=this.nil_node&&e.update_max()}},{key:"tree_walk",value:function(t,e){null!=t&&t!=this.nil_node&&(this.tree_walk(t.left,e),e(t),this.tree_walk(t.right,e))}},{key:"testRedBlackProperty",value:function(){var t=!0;return this.tree_walk(this.root,(function(e){0==e.color&&(1==e.left.color&&1==e.right.color||(t=!1))})),t}},{key:"testBlackHeightProperty",value:function(t){var e=0,r=0;if(1==t.color&&e++,(r=t.left!=this.nil_node?this.testBlackHeightProperty(t.left):1)!=(t.right!=this.nil_node?this.testBlackHeightProperty(t.right):1))throw new Error("Red-black height property violated");return e+=r}}]),t}();e.a=l}}]);
//# sourceMappingURL=37.09d31b93.chunk.js.map