{"version":3,"sources":["../../../packages/core/ui/ErrorMessage.tsx","../../../node_modules/@material-ui/icons/KeyboardArrowUp.js","../../../node_modules/@material-ui/icons/KeyboardArrowLeft.js","../../../node_modules/@material-ui/icons/KeyboardArrowRight.js","../../../plugins/dotplot-view/src/DotplotView/components/ImportForm.tsx","../../../plugins/dotplot-view/src/DotplotView/components/Controls.tsx","../../../plugins/dotplot-view/src/DotplotView/components/util.ts","../../../plugins/dotplot-view/src/DotplotView/components/Axes.tsx","../../../plugins/dotplot-view/src/DotplotView/components/DotplotView.tsx"],"names":["useStyles","makeStyles","theme","message","border","background","overflow","maxHeight","margin","spacing","padding","errorBox","ErrorMessage","error","classes","str","snapshotError","match","className","slice","JSON","stringify","parse","_interopRequireDefault","require","_interopRequireWildcard","Object","defineProperty","exports","value","default","React","_default","createElement","d","importFormContainer","DotplotImportForm","observer","model","session","getSession","assemblyNames","assemblyManager","useState","trackData","setTrackData","selected1","setSelected1","selected2","setSelected2","selected","setError","assemblyError","length","map","a","get","filter","f","join","displayError","Container","Grid","container","justifyContent","alignItems","style","width","item","Paper","textAlign","AssemblySelector","onChange","val","href","name","description","location","setLocation","loc","Button","onClick","isSessionWithAddTracks","setViews","bpPerPx","offsetPx","setAssemblyNames","fileName","uri","lastIndexOf","trackId","Date","now","addTrackConf","type","adapter","pafLocation","toggleTrack","e","console","disabled","variant","color","iconButton","controls","whiteSpace","position","boxSizing","right","top","zIndex","DotplotControls","IconButton","hview","scroll","title","vview","zoomOutButton","zoomInButton","activateTrackSelector","locstr","px","view","pxToBp","refName","start","offset","oob","coord","Math","floor","toLocaleString","getBlockLabelKeysToHide","blocks","viewOffsetPx","blockLabelKeysToHide","sortedBlocks","sort","b","alen","end","positions","Array","round","forEach","key","y","labelBounds","max","some","Boolean","push","fill","chooseGridPitch","scale","minMajorPitchPx","minMinorPitchPx","minMajorPitchBp","abs","majorMagnitude","parseInt","Number","toExponential","split","majorPitch","majorPitchPx","minorPitch","makeTicks","regions","emitMajor","emitMinor","ticks","gridPitch","iterPitch","i","region","index","minBase","maxBase","base","ceil","vtext","gridColumn","gridRow","pointerEvents","htext","majorTickLabel","fontSize","majorTick","stroke","minorTick","HorizontalAxis","viewWidth","borderY","htextRotation","hide","dynamicBlocks","contentBlocks","staticBlocks","height","includes","x","transform","dominantBaseline","textAnchor","tick","bpToPx","x1","x2","y1","y2","strokeWidth","VerticalAxis","borderX","viewHeight","vtextRotation","spacer","root","marginBottom","viewContainer","marginTop","display","overlay","cursor","content","popover","maxWidth","wordBreak","children","hblocks","vblocks","htop","displayedRegionsTotalPx","hbottom","vtop","vbottom","getOffset","rect","left","DotplotViewInternal","mousecurrClient","setMouseCurrClient","mousedownClient","setMouseDownClient","mouseupClient","setMouseUpClient","ref","useRef","distanceX","distanceY","lref","rref","timeout","delta","scheduled","blank","svg","current","getBoundingClientRect","rrect","lrect","mousedown","mousecurr","mouseup","mouserect","useEffect","onWheel","origEvent","event","normalizeWheel","preventDefault","ctrlKey","pixelY","setScaleFactor","clearTimeout","setTimeout","transaction","zoomTo","pixelX","window","requestAnimationFrame","curr","addEventListener","removeEventListener","globalMouseMove","clientX","clientY","cleanup","globalMouseUp","undefined","Controls","scaleFactor","role","onMouseDown","button","min","tracks","track","displays","RenderingComponent","getConf","open","onMenuItemClick","_","callback","onClose","anchorReference","anchorPosition","menuItems","label","zoomIn","onDotplotView","DotplotView","initialized","loading","ImportForm","LinearProgress"],"mappings":"yHAAA,mCAGMA,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCC,QAAS,CACPC,OAAQ,kBACRC,WAAY,OACZC,SAAU,OACVC,UAAW,IACXC,OAAQN,EAAMO,QAAQ,GACtBC,QAASR,EAAMO,QAAQ,IAGzBE,SAAU,CACRN,WAAY,YACZD,OAAQ,kBACRI,OAAQ,QA+BGI,UA5BM,SAAC,GAAkC,IAAhCC,EAAgC,EAAhCA,MAChBC,EAAUd,IAEZe,EAAM,GAAH,OAAMF,GACTG,EAAgB,GAIdC,EAAQF,EAAIE,MAAM,sDAKxB,OAJIA,IACFF,EAAM,6BAAH,OAAgCE,EAAM,IACzCD,EAAgBC,EAAM,IAGtB,yBAAKC,UAAWJ,EAAQX,SACrBY,EAAII,MAAM,EAAG,KACbH,EACC,gEAEE,yBAAKE,UAAWJ,EAAQH,UACrBS,KAAKC,UAAUD,KAAKE,MAAMN,GAAgB,KAAM,KAGnD,Q,kCCxCV,IAAIO,EAAyBC,EAAQ,IAEjCC,EAA0BD,EAAQ,KAEtCE,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAAQN,EAAwBD,EAAQ,IAIxCQ,GAAW,EAFMT,EAAuBC,EAAQ,MAElBM,SAAuBC,EAAME,cAAc,OAAQ,CACnFC,EAAG,mDACD,mBAEJN,EAAQE,QAAUE,G,kCCjBlB,IAAIT,EAAyBC,EAAQ,IAEjCC,EAA0BD,EAAQ,KAEtCE,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAAQN,EAAwBD,EAAQ,IAIxCQ,GAAW,EAFMT,EAAuBC,EAAQ,MAElBM,SAAuBC,EAAME,cAAc,OAAQ,CACnFC,EAAG,6DACD,qBAEJN,EAAQE,QAAUE,G,kCCjBlB,IAAIT,EAAyBC,EAAQ,IAEjCC,EAA0BD,EAAQ,KAEtCE,OAAOC,eAAeC,EAAS,aAAc,CAC3CC,OAAO,IAETD,EAAQE,aAAU,EAElB,IAAIC,EAAQN,EAAwBD,EAAQ,IAIxCQ,GAAW,EAFMT,EAAuBC,EAAQ,MAElBM,SAAuBC,EAAME,cAAc,OAAQ,CACnFC,EAAG,2DACD,sBAEJN,EAAQE,QAAUE,G,+MCTZhC,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCiC,oBAAqB,CACnBzB,QAASR,EAAMO,QAAQ,GACvBD,OAAQ,cA8HG4B,EA1HWC,oBAAS,YAA4C,IAAzCC,EAAyC,EAAzCA,MAC9BxB,EAAUd,IACVuC,EAAUC,qBAAWF,GACnBG,EAAmCF,EAAnCE,cAAeC,EAAoBH,EAApBG,gBACvB,EAAkCC,qBAAlC,mBAAOC,EAAP,KAAkBC,EAAlB,KACA,EAAkCF,mBAASF,EAAc,IAAzD,mBAAOK,EAAP,KAAkBC,EAAlB,KACA,EAAkCJ,mBAASF,EAAc,IAAzD,mBAAOO,EAAP,KAAkBC,EAAlB,KACMC,EAAW,CAACJ,EAAWE,GAC7B,EAA0BL,qBAA1B,mBAAO9B,EAAP,KAAcsC,EAAd,KAEMC,EAAgBX,EAAcY,OAChCH,EACGI,KAAI,SAAAC,GAAC,uBAAIb,EAAgBc,IAAID,UAAxB,aAAI,EAAwB1C,SACjC4C,QAAO,SAAAC,GAAC,QAAMA,KACdC,KAAK,MACR,2BAuCJ,IAAMC,EAAe/C,GAASuC,EAC9B,OACE,kBAACS,EAAA,EAAD,CAAW3C,UAAWJ,EAAQqB,qBAC3ByB,EAAe,kBAAChD,EAAA,QAAD,CAAcC,MAAO+C,IAAmB,KACxD,kBAACE,EAAA,EAAD,CACEC,WAAS,EACTtD,QAAS,EACTuD,eAAe,SACfC,WAAW,SACXC,MAAO,CAAEC,MAAO,MAAO3D,OAAQ,WAE/B,kBAACsD,EAAA,EAAD,CAAMM,MAAI,GACR,kBAACC,EAAA,EAAD,CAAOH,MAAO,CAAExD,QAAS,KACvB,uBAAGwD,MAAO,CAAEI,UAAW,WAAvB,sCAGA,kBAACC,EAAA,EAAD,CACErB,SAAUJ,EACV0B,SAAU,SAAAC,GAAG,OAAI1B,EAAa0B,IAC9BlC,QAASA,IAEX,kBAACgC,EAAA,EAAD,CACErB,SAAUF,EACVwB,SAAU,SAAAC,GAAG,OAAIxB,EAAawB,IAC9BlC,QAASA,KAIb,kBAAC8B,EAAA,EAAD,CAAOH,MAAO,CAAExD,QAAS,KACvB,uBAAGwD,MAAO,CAAEI,UAAW,WACrB,uCADF,cAC6B,IAC3B,uBAAGI,KAAK,qDAAR,6BAEK,IAJP,mJASA,kBAACZ,EAAA,EAAD,CAAMC,WAAS,EAACC,eAAe,UAC7B,kBAACF,EAAA,EAAD,CAAMM,MAAI,GACR,kBAAC,eAAD,CACEO,KAAK,MACLC,YAAY,GACZC,SAAUjC,EACVkC,YAAa,SAAAC,GAAG,OAAIlC,EAAakC,UAM3C,kBAACjB,EAAA,EAAD,CAAMM,MAAI,GACR,kBAACY,EAAA,EAAD,CACE,cAAY,gBACZC,QA1FV,WACE,IACE,IAAKC,iCAAuB3C,GAC1B,OAEFD,EAAM6C,SAAS,CACb,CAAEC,QAAS,GAAKC,SAAU,GAC1B,CAAED,QAAS,GAAKC,SAAU,KAE5B/C,EAAMgD,iBAAiB,CAACxC,EAAWE,IAEnC,IAAMuC,EACJ3C,GAAa,QAASA,GAAaA,EAAU4C,IACzC5C,EAAU4C,IAAIrE,MAAMyB,EAAU4C,IAAIC,YAAY,KAAO,GACrD,UAEAC,EAAU,GAAH,OAAMH,EAAN,YAAkBI,KAAKC,OAEpCrD,EAAQsD,aAAa,CACnBH,QAAS,GAAF,OAAKH,EAAL,YAAiBI,KAAKC,OAC7BjB,KAAMY,EACN9C,cAAeS,EACf4C,KAAM,eACNC,QAAS,CACPD,KAAM,aACNE,YAAapD,EACbH,cAAeS,KAGnBZ,EAAM2D,YAAYP,GAClB,MAAOQ,GACPC,QAAQtF,MAAMqF,GACd/C,EAAS+C,KA6DHE,WAAYhD,EACZiD,QAAQ,YACRC,MAAM,WAPR,c,oIC3GJtG,EAAYC,YAAW,CAC3BsG,WAAY,CACV7F,QAAS,MACTF,OAAQ,eAEVgG,SAAU,CACRlG,SAAU,SACVD,WAAY,QACZoG,WAAY,SACZC,SAAU,WACVC,UAAW,aACXvG,OAAQ,oBACRwG,MAAO,EACPC,IAAK,EACLC,OAAQ,QA+EGC,EA3ES1E,oBAAS,YAA4C,IAAzCC,EAAyC,EAAzCA,MAC5BxB,EAAUd,IAChB,OACE,yBAAKkB,UAAWJ,EAAQ0F,UACtB,kBAACQ,EAAA,EAAD,CACE/B,QAAS,WACP3C,EAAM2E,MAAMC,QAAQ,MAEtBhG,UAAWJ,EAAQyF,WACnBY,MAAM,OACNb,MAAM,aAEN,kBAAC,IAAD,OAGF,kBAACU,EAAA,EAAD,CACE/B,QAAS,WACP3C,EAAM2E,MAAMC,OAAO,MAErBhG,UAAWJ,EAAQyF,WACnBY,MAAM,OACNb,MAAM,aAEN,kBAAC,IAAD,OAEF,kBAACU,EAAA,EAAD,CACE/B,QAAS,WACP3C,EAAM8E,MAAMF,OAAO,MAErBhG,UAAWJ,EAAQyF,WACnBY,MAAM,OACNb,MAAM,aAEN,kBAAC,IAAD,OAEF,kBAACU,EAAA,EAAD,CACE/B,QAAS,WACP3C,EAAM8E,MAAMF,QAAQ,MAEtBhG,UAAWJ,EAAQyF,WACnBY,MAAM,OACNb,MAAM,aAEN,kBAAC,IAAD,OAEF,kBAACU,EAAA,EAAD,CACE/B,QAAS3C,EAAM+E,cACfnG,UAAWJ,EAAQyF,WACnBD,MAAM,aAEN,kBAAC,IAAD,OAGF,kBAACU,EAAA,EAAD,CACE/B,QAAS3C,EAAMgF,aACfpG,UAAWJ,EAAQyF,WACnBY,MAAM,UACNb,MAAM,aAEN,kBAAC,IAAD,OAGF,kBAACU,EAAA,EAAD,CACE/B,QAAS3C,EAAMiF,sBACfJ,MAAM,sBACNtF,MAAM,eACN,cAAY,wBACZyE,MAAM,aAEN,kBAAC,IAAD,WCnGD,SAASkB,EAAOC,EAAYC,GACjC,MAAwCA,EAAKC,OAAOF,GAA5CG,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,MAAOC,EAAxB,EAAwBA,OAAQC,EAAhC,EAAgCA,IAC1BC,EAAQC,KAAKC,MAAML,EAAQC,GACjC,OAAOC,EAAM,gBAAH,UAAwBH,EAAxB,YAAmCI,EAAMG,eAAe,UAG7D,SAASC,EACdC,EACAhF,EACAiF,GAEA,IAAMC,EAAiC,GACjCC,EAAeH,EAAOlH,MAAM,GAAGsH,MAAK,SAAClF,EAAGmF,GAC5C,IAAMC,EAAOpF,EAAEqF,IAAMrF,EAAEsE,MAEvB,OADaa,EAAEE,IAAMF,EAAEb,MACTc,KAEVE,EAAY,IAAIC,MAAMb,KAAKc,MAAM1F,IAUvC,OATAmF,EAAaQ,SAAQ,YAAuB,IAApBC,EAAoB,EAApBA,IAAK5D,EAAe,EAAfA,SACrB6D,EAAIjB,KAAKc,MAAM1F,EAASgC,EAAWiD,GACnCa,EAAc,CAAClB,KAAKmB,IAAIF,EAAI,GAAI,GAAIA,GAChC,IAANA,GAAWL,EAAU1H,MAAV,MAAA0H,EAAmBM,GAAaE,KAAKC,SAClDf,EAAqBgB,KAAKN,GAE1BJ,EAAUW,KAAV,MAAAX,EAAS,EAAM,GAAN,OAAeM,OAGrBZ,EAOF,SAASkB,EACdC,EACAC,EACAC,GAUA,IAPA,IAAMC,EAAkBF,GADxBD,EAAQzB,KAAK6B,IAAIJ,IAEXK,EAAiBC,SACrBC,OAAOJ,GAAiBK,gBAAgBC,MAAM,MAAM,GACpD,IAGEC,EAAa,KAAH,IAAG,GAAML,GAChBK,EAAaP,MAClBO,GAAc,IACIP,IAGlBO,GAAc,IAKhB,IAAMC,GAFND,EAAanC,KAAKmB,IAAIgB,EAAY,IAEAV,EAE9BY,EAAa,EASjB,QARMF,EAAa,KAAOC,EAAe,IAAMT,EAC7CU,EAAaF,EAAa,KACfA,EAAa,IAAMC,EAAe,GAAKT,EAClDU,EAAaF,EAAa,IACfA,EAAa,IAAMC,EAAe,GAAKT,IAClDU,EAAaF,EAAa,GAGrB,CAAEA,aAAYE,cAGhB,SAASC,EACdC,EACApF,GAOA,IAJA,IAFAqF,IAEA,yDADAC,IACA,yDACMC,EAAQ,GACRC,EAAYnB,EAAgBrE,EAAS,GAAI,IACzCyF,EAAYD,EAAUN,YAAcM,EAAUR,WAC3CU,EAAI,EAAGA,EAAIN,EAAQnH,OAAQyH,IAOlC,IANA,IAAMC,EAASP,EAAQM,GACfjD,EAAwBkD,EAAxBlD,MAAOe,EAAiBmC,EAAjBnC,IAAKhB,EAAYmD,EAAZnD,QAChBoD,EAAQ,EAENC,EAAUpD,EACVqD,EAAUtC,EAEVuC,EAAOlD,KAAKmD,KAAKH,EAAUJ,GAAaA,EAC5CM,EAAOD,EACPC,GAAQN,EAEJH,GAAaS,EAAOP,EAAUR,YAChCO,EAAMpB,KAAK,CAAEzD,KAAM,QAASqF,KAAMA,EAAO,EAAGH,QAAOpD,YACnDoD,GAAS,GAETP,GACAxC,KAAK6B,IAAIqB,EAAOJ,EAAOlD,OAAS+C,EAAUN,aAE1CK,EAAMpB,KAAK,CAAEzD,KAAM,QAASqF,KAAMA,EAAO,EAAGH,QAAOpD,YACnDoD,GAAS,GAIf,OAAOL,ECrGT,IAAM3K,EAAYC,aAAW,iBAAO,CAClCoL,MAAO,CACLC,WAAY,MACZC,QAAS,MACTC,cAAe,QAEjBC,MAAO,CACLH,WAAY,MACZC,QAAS,MACTC,cAAe,QAEjBE,eAAgB,CACdC,SAAU,QAEZC,UAAW,CACTC,OAAQ,QAEVC,UAAW,CACTD,OAAQ,YAICE,EAAiB1J,oBAC5B,YAA4C,IAAzCC,EAAyC,EAAzCA,MACKxB,EAAUd,IACRgM,EAA6C1J,EAA7C0J,UAAWC,EAAkC3J,EAAlC2J,QAAShF,EAAyB3E,EAAzB2E,MAAOiF,EAAkB5J,EAAlB4J,cAC7BC,EAAO/D,EACXnB,EAAMmF,cAAcC,cACpBL,EACA/E,EAAM5B,UAEFsF,EAAQJ,EAAUtD,EAAMqF,aAAaD,cAAepF,EAAM7B,SAChE,OACE,yBAAKjB,MAAO6H,EAAWO,OAAQN,EAAS/K,UAAWJ,EAAQ2K,OACzD,2BACGxE,EAAMmF,cAAcC,cAClB5I,QAAO,SAAAsH,GAAM,OAAKoB,EAAKK,SAASzB,EAAO9B,QACvC3F,KAAI,SAAAyH,GACH,IAAM0B,EAAI1B,EAAO1F,SAEjB,OACE,0BACEqH,UAAS,iBAAYR,EAAZ,YACPO,EAAIxF,EAAM5B,SADH,YAHH,EAGG,KAGT4D,IAAK7H,KAAKC,UAAU0J,GACpB0B,EAAGA,EAAIxF,EAAM5B,SACb6D,EAAGA,EACHM,KAAK,UACLmD,iBAAiB,UACjBC,WAAW,OATb,UAWM7B,EAAOnD,QAXb,YAYqB,IAAjBmD,EAAOlD,MACHI,KAAKC,MAAM6C,EAAOlD,OAAOM,eAAe,SACxC,QAKbwC,EAAMrH,KAAI,SAAAuJ,GACT,IAAMJ,GACHxF,EAAM6F,OAAO,CAAElF,QAASiF,EAAKjF,QAASI,MAAO6E,EAAK1B,QAAW,GAC9DlE,EAAM5B,SACR,OACE,0BACE4D,IAAG,eAAU7H,KAAKC,UAAUwL,IAC5BE,GAAIN,EACJO,GAAIP,EACJQ,GAAI,EACJC,GAAkB,UAAdL,EAAK/G,KAAmB,EAAI,EAChCqH,YAAa,EACbtB,OAAsB,UAAdgB,EAAK/G,KAAmB,OAAS,OACzC5E,UACgB,UAAd2L,EAAK/G,KAAmBhF,EAAQ8K,UAAY9K,EAAQgL,UAEtD,UAASe,EAAK1B,UAInBR,EACElH,QAAO,SAAAoJ,GAAI,MAAkB,UAAdA,EAAK/G,QACpBxC,KAAI,SAAAuJ,GACH,IAAMJ,GACHxF,EAAM6F,OAAO,CAAElF,QAASiF,EAAKjF,QAASI,MAAO6E,EAAK1B,QACjD,GAAKlE,EAAM5B,SAEf,OACE,0BACEoH,EAAGA,EAAI,EACPvD,EAJM,EAKNwD,UAAS,iBAAYR,EAAZ,YAA6BO,EAA7B,YALH,EAKG,KACTxD,IAAG,eAAU7H,KAAKC,UAAUwL,IAC5B3I,MAAO,CAAEyH,SAAU,QACnBzK,UAAWJ,EAAQ4K,eACnBiB,iBAAiB,SACjBC,WAAW,QAETC,EAAK1B,KAAO,GAAGhD,eAAe,kBASrCiF,EAAe/K,oBAC1B,YAA4C,IAAzCC,EAAyC,EAAzCA,MACKxB,EAAUd,IACRqN,EAA8C/K,EAA9C+K,QAASC,EAAqChL,EAArCgL,WAAYlG,EAAyB9E,EAAzB8E,MAAOmG,EAAkBjL,EAAlBiL,cAC9BpB,EAAO/D,EACXhB,EAAMgF,cAAcC,cACpBiB,EACAlG,EAAM/B,UAEFsF,EAAQJ,EAAUnD,EAAMkF,aAAaD,cAAejF,EAAMhC,SAChE,OACE,yBAAKlE,UAAWJ,EAAQuK,MAAOlH,MAAOkJ,EAASd,OAAQe,GACrD,2BACGlG,EAAMgF,cAAcC,cAClB5I,QAAO,SAAAsH,GAAM,OAAKoB,EAAKK,SAASzB,EAAO9B,QACvC3F,KAAI,SAAAyH,GACH,IAAM7B,EAAI6B,EAAO1F,SACXoH,EAAIY,EACV,OACE,0BACEX,UAAS,iBAAYa,EAAZ,YAA6Bd,EAA7B,YAAkCvD,EAAlC,KACTD,IAAK7H,KAAKC,UAAU0J,GACpB0B,EAAGY,EACHnE,EAAGoE,EAAapE,EAAI9B,EAAM/B,SAC1BmE,KAAK,UACLoD,WAAW,OANb,UAQM7B,EAAOnD,QARb,YASqB,IAAjBmD,EAAOlD,MAAcI,KAAKC,MAAM6C,EAAOlD,OAAS,QAKzD8C,EAAMrH,KAAI,SAAAuJ,GACT,IAAM3D,GACH9B,EAAM0F,OAAO,CAAElF,QAASiF,EAAKjF,QAASI,MAAO6E,EAAK1B,QAAW,GAC9D/D,EAAM/B,SACR,OACE,0BACE4D,IAAG,eAAU7H,KAAKC,UAAUwL,IAC5BI,GAAIK,EAAapE,EACjBgE,GAAII,EAAapE,EACjB6D,GAAIM,EACJL,GAAIK,GAAyB,UAAdR,EAAK/G,KAAmB,EAAI,GAC3CqH,YAAa,EACbtB,OAAsB,UAAdgB,EAAK/G,KAAmB,OAAS,OACzC5E,UACgB,UAAd2L,EAAK/G,KAAmBhF,EAAQ8K,UAAY9K,EAAQgL,UAEtD,UAASe,EAAK1B,UAInBR,EACElH,QAAO,SAAAoJ,GAAI,MAAkB,UAAdA,EAAK/G,QACpBxC,KAAI,SAAAuJ,GACH,IAAM3D,GACH9B,EAAM0F,OAAO,CAAElF,QAASiF,EAAKjF,QAASI,MAAO6E,EAAK1B,QACjD,GAAK/D,EAAM/B,SACf,OACE,0BACE6D,EAAGoE,EAAapE,EAAI,EACpBuD,EAAGY,EAAU,EACbpE,IAAG,eAAU7H,KAAKC,UAAUwL,IAC5BD,WAAW,MACXD,iBAAiB,UACjBzI,MAAO,CAAEyH,SAAU,QACnBzK,UAAWJ,EAAQ4K,iBAEjBmB,EAAK1B,KAAO,GAAGhD,eAAe,kBCzK5CnI,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCsN,OAAQ,CACNlC,WAAY,MACZC,QAAS,OAEXkC,KAAM,CACJ/G,SAAU,WACVgH,aAAcxN,EAAMO,QAAQ,GAC5BH,SAAU,UAEZqN,cAAe,CACbC,UAAW,OAEb7J,UAAW,CACT8J,QAAS,OACTnN,QAAS,EACTgG,SAAU,YAEZoH,QAAS,CACPtC,cAAe,OACflL,SAAU,SACVuN,QAAS,OACT1J,MAAO,OACPoH,QAAS,MACTD,WAAY,MACZxE,OAAQ,IACR,SAAU,CACRiH,OAAQ,YACRvE,KAAM,SAIVwE,QAAS,CACP1C,WAAY,MACZC,QAAS,OAGX0C,QAAS,CACP5N,WAAY,OACZ6N,SAAU,IACVC,UAAW,YACXrH,OAAQ,IACR1G,OAAQ,kBACRoL,cAAe,OACf9E,SAAU,gBAQR5C,EAAOzB,oBACX,YAQM,IAPJC,EAOI,EAPJA,MACA8L,EAMI,EANJA,SAMI,IALJvC,cAKI,MALK,QAKL,EACIG,EAAwC1J,EAAxC0J,UAAWsB,EAA6BhL,EAA7BgL,WAAYrG,EAAiB3E,EAAjB2E,MAAOG,EAAU9E,EAAV8E,MAChCiH,EAAUpH,EAAMmF,cAAcC,cAC9BiC,EAAUlH,EAAMgF,cAAcC,cAC9BkC,EAAOtH,EAAMuH,wBAA0BvH,EAAM5B,SAC7CoJ,EAAUJ,EAAQ,GAAGhJ,SAAW4B,EAAM5B,SACtCqJ,EAAOtH,EAAMoH,wBAA0BpH,EAAM/B,SAC7CsJ,EAAUL,EAAQ,GAAGjJ,SAAW+B,EAAM/B,SAC5C,OACE,yBACEnB,MAAO,CAAE7D,WAAY,oBACrB8D,MAAO6H,EACPO,OAAQe,GAER,0BACEb,EAAGgC,EACHvF,EAAGoE,EAAaoB,EAChBvK,MAAOoK,EAAOE,EACdlC,OAAQmC,EAAOC,EACfnF,KAAK,SAEP,2BACG6E,EAAQ/K,KAAI,SAAAyH,GACX,IAAM0B,EAAI1B,EAAO1F,SAAW4B,EAAM5B,SAClC,OACE,0BACE4D,IAAK7H,KAAKC,UAAU0J,GACpBgC,GAAIN,EACJQ,GAAI,EACJD,GAAIP,EACJS,GAAII,EACJzB,OAAQA,OAIbyC,EAAQhL,KAAI,SAAAyH,GACX,IAAM7B,EAAIoE,GAAcvC,EAAO1F,SAAW+B,EAAM/B,UAChD,OACE,0BACE4D,IAAK7H,KAAKC,UAAU0J,GACpBgC,GAAI,EACJE,GAAI/D,EACJ8D,GAAIhB,EACJkB,GAAIhE,EACJ2C,OAAQA,OAId,0BAAMkB,GAAIwB,EAAMtB,GAAI,EAAGD,GAAIuB,EAAMrB,GAAII,EAAYzB,OAAQA,IACzD,0BACEkB,GAAI,EACJE,GAAIK,EAAaoB,EACjB1B,GAAIhB,EACJkB,GAAII,EAAaoB,EACjB7C,OAAQA,KAGXuC,MAOT,SAASQ,EAAU5G,EAAc6G,GAC/B,OAAO7G,GAAU,CAACA,EAAM,GAAK6G,EAAKC,KAAM9G,EAAM,GAAK6G,EAAKhI,KAG1D,IAAMkI,EAAsB1M,oBAC1B,YAA4C,UAAzCC,EAAyC,EAAzCA,MACO2E,EAA6B3E,EAA7B2E,MAAOG,EAAsB9E,EAAtB8E,MAAOkG,EAAehL,EAAfgL,WAChBxM,EAAUd,IAChB,EAA8C2C,qBAA9C,mBAAOqM,EAAP,KAAwBC,EAAxB,KACA,EAA8CtM,qBAA9C,mBAAOuM,EAAP,KAAwBC,EAAxB,KACA,EAA0CxM,qBAA1C,mBAAOyM,EAAP,KAAsBC,EAAtB,KACMC,EAAMC,iBAAuB,MAC7B9B,EAAO8B,iBAAuB,MAC9BC,EAAYD,iBAAO,GACnBE,EAAYF,iBAAO,GACnBG,EAAOH,iBAAuB,MAC9BI,EAAOJ,iBAAuB,MAC9BK,EAAUL,mBACVM,EAAQN,iBAAO,GACfO,EAAYP,kBAAO,GACnBQ,EAAQ,CAAEjB,KAAM,EAAGjI,IAAK,EAAG1C,MAAO,EAAGoI,OAAQ,GAC7CyD,GAAM,UAAAV,EAAIW,eAAJ,eAAaC,0BAA2BH,EAC9CI,GAAQ,UAAAR,EAAKM,eAAL,eAAcC,0BAA2BH,EACjDK,GAAQ,UAAAV,EAAKO,eAAL,eAAcC,0BAA2BH,EACjDM,EAAYzB,EAAUM,EAAiBc,GACvCM,EAAY1B,EAAUI,EAAiBgB,GACvCO,EAAU3B,EAAUQ,EAAeY,GACnCQ,EAAYD,GAAWD,EAqG7B,OAlGAG,qBAAU,WACR,SAASC,EAAQC,GACf,IAAMC,EAAQC,IAAeF,GAC7BA,EAAUG,kBACgB,IAAtBH,EAAUI,SACZlB,EAAMI,SAAWW,EAAMI,OAAS,IAChC1O,EAAM8E,MAAM6J,eACVpB,EAAMI,QAAU,EAAI,EAAIJ,EAAMI,QAAU,GAAK,EAAIJ,EAAMI,UAEzD3N,EAAM2E,MAAMgK,eACVpB,EAAMI,QAAU,EAAI,EAAIJ,EAAMI,QAAU,GAAK,EAAIJ,EAAMI,UAErDL,EAAQK,SACViB,aAAatB,EAAQK,SAEvBL,EAAQK,QAAUkB,YAAW,WAC3BC,uBAAY,WACV9O,EAAM2E,MAAMgK,eAAe,GAC3B3O,EAAM8E,MAAM6J,eAAe,GAC3B3O,EAAM2E,MAAMoK,OACVxB,EAAMI,QAAU,EACZ3N,EAAM2E,MAAM7B,SAAW,EAAIyK,EAAMI,SACjC3N,EAAM2E,MAAM7B,SAAW,EAAIyK,EAAMI,UAEvC3N,EAAM8E,MAAMiK,OACVxB,EAAMI,QAAU,EACZ3N,EAAM8E,MAAMhC,SAAW,EAAIyK,EAAMI,SACjC3N,EAAM8E,MAAMhC,SAAW,EAAIyK,EAAMI,aAGzCJ,EAAMI,QAAU,IACf,OAEHT,EAAUS,SAAWW,EAAMU,OAC3B7B,EAAUQ,SAAWW,EAAMI,OACtBlB,EAAUG,UACbH,EAAUG,SAAU,EAEpBsB,OAAOC,uBAAsB,WAC3BJ,uBAAY,WACV9O,EAAM2E,MAAMC,OAAOsI,EAAUS,SAC7B3N,EAAM8E,MAAMF,OAAOuI,EAAUQ,YAE/BH,EAAUG,SAAU,EACpBT,EAAUS,QAAU,EACpBR,EAAUQ,QAAU,OAK5B,GAAIX,EAAIW,QAAS,CACf,IAAMwB,EAAOnC,EAAIW,QAEjB,OADAwB,EAAKC,iBAAiB,QAAShB,GACxB,WACLe,EAAKE,oBAAoB,QAASjB,IAGtC,OAAO,eACN,CAACpO,EAAM2E,MAAO3E,EAAM8E,QAEvBqJ,qBAAU,WACR,SAASmB,EAAgBhB,GACvB3B,EAAmB,CAAC2B,EAAMiB,QAASjB,EAAMkB,UAI3C,OADAP,OAAOG,iBAAiB,YAAaE,GAC9B,WACLL,OAAOI,oBAAoB,YAAaC,MAEzC,IAIHnB,qBAAU,WACR,IAAIsB,EAAU,aAEd,SAASC,EAAcpB,GAEnBP,GACAC,GACArI,KAAK6B,IAAIuG,EAAU,GAAKC,EAAU,IAAM,GACxCrI,KAAK6B,IAAIuG,EAAU,GAAKC,EAAU,IAAM,EAExCjB,EAAiB,CAACuB,EAAMiB,QAASjB,EAAMkB,UAEvC3C,OAAmB8C,GAUvB,OANI5B,IAAcE,IAChBgB,OAAOG,iBAAiB,UAAWM,GAAe,GAClDD,EAAU,WACRR,OAAOI,oBAAoB,UAAWK,GAAe,KAGlDD,IACN,CAAC1B,EAAWC,EAAWC,IAGxB,yBAAKjB,IAAK7B,EAAMvM,UAAWJ,EAAQ2M,MACjC,kBAACyE,EAAD,CAAU5P,MAAOA,IAEjB,yBAAKpB,UAAWJ,EAAQiD,WACtB,yBACEG,MAAO,CACL2J,QAAS,OACTnB,UAAW,UAAF,OAAYpK,EAAM2E,MAAMkL,YAAxB,oBAA+C7P,EAAM8E,MAAM+K,YAA3D,OAGX,kBAAC/E,EAAD,CAAc9K,MAAOA,IACrB,kBAACyJ,EAAD,CAAgBzJ,MAAOA,IACvB,yBACEgN,IAAKA,EACLpL,MAAO,CAAEwC,SAAU,YACnBxF,UAAWJ,EAAQkN,SAElBwC,EACC,yBACElB,IAAKI,EACLxO,UAAWJ,EAAQmN,QACnB/J,MAAO,CACL4K,KACE0B,EAAU,IACTH,GAAaG,EAAU,GAAKH,EAAU,GAAK,EACxCD,EAAMjM,MACN,GACN0C,IACE2J,EAAU,IACTH,GAAaG,EAAU,GAAKH,EAAU,GAAK,EACxCD,EAAM7D,OACN,KAbV,YAgBQ/E,EAAOgJ,EAAU,GAAIvJ,IAC3B,6BAjBF,YAkBQO,EAAO8F,EAAakD,EAAU,GAAIpJ,KAExC,KACHiJ,GACDG,GACAvI,KAAK6B,IAAIuG,EAAU,GAAKG,EAAU,IAAM,GACxCvI,KAAK6B,IAAIuG,EAAU,GAAKG,EAAU,IAAM,EACtC,yBACElB,IAAKK,EACLzO,UAAWJ,EAAQmN,QACnB/J,MAAO,CACL4K,KACEuB,EAAU,IACTG,EAAU,GAAKH,EAAU,GAAK,EAAI,EAAIF,EAAMhM,OAC/C0C,IACEwJ,EAAU,IACTG,EAAU,GAAKH,EAAU,GAAK,EAAI,EAAIF,EAAM5D,UATnD,YAYQ/E,EAAO6I,EAAU,GAAIpJ,IAC3B,6BAbF,YAcQO,EAAO8F,EAAa+C,EAAU,GAAIjJ,KAExC,KAEJ,yBACEgL,KAAK,eACLlO,MAAO,CAAE6J,OAAQ,aACjBsE,YAAa,SAAAzB,GACU,IAAjBA,EAAM0B,SACRnD,EAAmB,CAACyB,EAAMiB,QAASjB,EAAMkB,UACzC7C,EAAmB,CAAC2B,EAAMiB,QAASjB,EAAMkB,aAI7C,kBAAC,EAAD,CAAMxP,MAAOA,GACV+N,GAAaG,EACZ,0BACEhH,KAAK,oBACLiD,EAAGxE,KAAKsK,IAAI/B,EAAU,GAAIH,EAAU,IACpCnH,EAAGjB,KAAKsK,IAAI/B,EAAU,GAAIH,EAAU,IACpClM,MAAO8D,KAAK6B,IAAI0G,EAAU,GAAKH,EAAU,IACzC9D,OAAQtE,KAAK6B,IAAI0G,EAAU,GAAKH,EAAU,MAE1C,OAGR,yBAAKnP,UAAWJ,EAAQ0M,UAE1B,yBAAKtM,UAAWJ,EAAQgN,SACrBxL,EAAMkQ,OAAOlP,KAAI,SAAAmP,GAChB,IAAO5E,EAAP,YAAkB4E,EAAMC,SAAxB,MACQC,EAAuB9E,EAAvB8E,mBAER,OAAOA,EACL,kBAACA,EAAD,CACE1J,IAAK2J,kBAAQH,EAAO,WACpBnQ,MAAOuL,IAEP,SAGR,kBAAC,OAAD,CACEgF,KAAMvJ,QAAQiH,GACduC,gBAAiB,SAACC,EAAGC,GACnBA,IACA3D,OAAiB4C,GACjB9C,OAAmB8C,IAErBgB,QAAS,WACP5D,OAAiB4C,GACjB9C,OAAmB8C,IAErBiB,gBAAgB,iBAChBC,eACE/D,EACI,CACEvI,IAAKuI,EAAc,GAAK,GACxBN,KAAMM,EAAc,GAAK,SAE3B6C,EAEN/N,MAAO,CAAE4C,OAAQ,KACjBsM,UAAW,CACT,CACEC,MAAO,UACPpO,QAAS,WACHoL,GAAaE,GACfjO,EAAMgR,OAAOjD,EAAWE,KAI9B,CACE8C,MAAO,2BACPpO,QAAS,WACHoL,GAAaE,GACfjO,EAAMiR,cAAclD,EAAWE,cAY/CiD,EAAcnR,oBAAS,YAA4C,IAAzCC,EAAyC,EAAzCA,MACtBmR,EAAgCnR,EAAhCmR,YAAaC,EAAmBpR,EAAnBoR,QAAS7S,EAAUyB,EAAVzB,MAE9B,OAAM4S,IAAgBC,GAAY7S,EACzB,kBAAC8S,EAAD,CAAYrR,MAAOA,IAGxBoR,EAEA,6BACE,yCACA,kBAACE,EAAA,EAAD,OAKC,kBAAC7E,EAAD,CAAqBzM,MAAOA,OAGtBkR","file":"static/js/33.623adddf.chunk.js","sourcesContent":["import React from 'react'\nimport { makeStyles } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  message: {\n    border: '1px solid black',\n    background: '#f88',\n    overflow: 'auto',\n    maxHeight: 200,\n    margin: theme.spacing(1),\n    padding: theme.spacing(1),\n  },\n\n  errorBox: {\n    background: 'lightgrey',\n    border: '1px solid black',\n    margin: 20,\n  },\n}))\nconst ErrorMessage = ({ error }: { error: unknown }) => {\n  const classes = useStyles()\n\n  let str = `${error}`\n  let snapshotError = ''\n\n  // best effort to make a better error message than the default\n  // mobx-state-tree\n  const match = str.match(/.*at path \"(.*)\" snapshot `(.*)` is not assignable/)\n  if (match) {\n    str = `Failed to load element at ${match[1]}`\n    snapshotError = match[2]\n  }\n  return (\n    <div className={classes.message}>\n      {str.slice(0, 10000)}\n      {snapshotError ? (\n        <div>\n          ... Failed element had snapshot:\n          <pre className={classes.errorBox}>\n            {JSON.stringify(JSON.parse(snapshotError), null, 2)}\n          </pre>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default ErrorMessage\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z\"\n}), 'KeyboardArrowUp');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z\"\n}), 'KeyboardArrowLeft');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z\"\n}), 'KeyboardArrowRight');\n\nexports.default = _default;","import React, { useState } from 'react'\nimport { Button, Paper, Container, Grid, makeStyles } from '@material-ui/core'\nimport { FileSelector } from '@jbrowse/core/ui'\nimport { FileLocation } from '@jbrowse/core/util/types'\nimport { observer } from 'mobx-react'\nimport { getSession, isSessionWithAddTracks } from '@jbrowse/core/util'\nimport ErrorMessage from '@jbrowse/core/ui/ErrorMessage'\nimport AssemblySelector from '@jbrowse/core/ui/AssemblySelector'\nimport { DotplotViewModel } from '../model'\n\nconst useStyles = makeStyles(theme => ({\n  importFormContainer: {\n    padding: theme.spacing(4),\n    margin: '0 auto',\n  },\n}))\n\nconst DotplotImportForm = observer(({ model }: { model: DotplotViewModel }) => {\n  const classes = useStyles()\n  const session = getSession(model)\n  const { assemblyNames, assemblyManager } = session\n  const [trackData, setTrackData] = useState<FileLocation>()\n  const [selected1, setSelected1] = useState(assemblyNames[0])\n  const [selected2, setSelected2] = useState(assemblyNames[0])\n  const selected = [selected1, selected2]\n  const [error, setError] = useState<unknown>()\n\n  const assemblyError = assemblyNames.length\n    ? selected\n        .map(a => assemblyManager.get(a)?.error)\n        .filter(f => !!f)\n        .join(', ')\n    : 'No configured assemblies'\n\n  function onOpenClick() {\n    try {\n      if (!isSessionWithAddTracks(session)) {\n        return\n      }\n      model.setViews([\n        { bpPerPx: 0.1, offsetPx: 0 },\n        { bpPerPx: 0.1, offsetPx: 0 },\n      ])\n      model.setAssemblyNames([selected1, selected2])\n\n      const fileName =\n        trackData && 'uri' in trackData && trackData.uri\n          ? trackData.uri.slice(trackData.uri.lastIndexOf('/') + 1)\n          : 'MyTrack'\n\n      const trackId = `${fileName}-${Date.now()}`\n\n      session.addTrackConf({\n        trackId: `${fileName}-${Date.now()}`,\n        name: fileName,\n        assemblyNames: selected,\n        type: 'SyntenyTrack',\n        adapter: {\n          type: 'PAFAdapter',\n          pafLocation: trackData,\n          assemblyNames: selected,\n        },\n      })\n      model.toggleTrack(trackId)\n    } catch (e) {\n      console.error(e)\n      setError(e)\n    }\n  }\n\n  // this is a combination of any displayed error message we have\n  const displayError = error || assemblyError\n  return (\n    <Container className={classes.importFormContainer}>\n      {displayError ? <ErrorMessage error={displayError} /> : null}\n      <Grid\n        container\n        spacing={1}\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        style={{ width: '50%', margin: '0 auto' }}\n      >\n        <Grid item>\n          <Paper style={{ padding: 12 }}>\n            <p style={{ textAlign: 'center' }}>\n              Select assemblies for dotplot view\n            </p>\n            <AssemblySelector\n              selected={selected1}\n              onChange={val => setSelected1(val)}\n              session={session}\n            />\n            <AssemblySelector\n              selected={selected2}\n              onChange={val => setSelected2(val)}\n              session={session}\n            />\n          </Paper>\n\n          <Paper style={{ padding: 12 }}>\n            <p style={{ textAlign: 'center' }}>\n              <b>Optional</b>: Add a PAF{' '}\n              <a href=\"https://github.com/lh3/miniasm/blob/master/PAF.md\">\n                (pairwise mapping format)\n              </a>{' '}\n              file for the dotplot view. Note that the first assembly should be\n              the left column of the PAF and the second assembly should be the\n              right column\n            </p>\n            <Grid container justifyContent=\"center\">\n              <Grid item>\n                <FileSelector\n                  name=\"URL\"\n                  description=\"\"\n                  location={trackData}\n                  setLocation={loc => setTrackData(loc)}\n                />\n              </Grid>\n            </Grid>\n          </Paper>\n        </Grid>\n        <Grid item>\n          <Button\n            data-testid=\"submitDotplot\"\n            onClick={onOpenClick}\n            // only disable button on assemblyError. for other types of errors\n            // in the useState can retry\n            disabled={!!assemblyError}\n            variant=\"contained\"\n            color=\"primary\"\n          >\n            Open\n          </Button>\n        </Grid>\n      </Grid>\n    </Container>\n  )\n})\n\nexport default DotplotImportForm\n","import React from 'react'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport ZoomOut from '@material-ui/icons/ZoomOut'\nimport ZoomIn from '@material-ui/icons/ZoomIn'\nimport ArrowUp from '@material-ui/icons/KeyboardArrowUp'\nimport ArrowDown from '@material-ui/icons/KeyboardArrowDown'\nimport ArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport ArrowRight from '@material-ui/icons/KeyboardArrowRight'\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport { observer } from 'mobx-react'\nimport { DotplotViewModel } from '../model'\n\nconst useStyles = makeStyles({\n  iconButton: {\n    padding: '4px',\n    margin: '0 2px 0 2px',\n  },\n  controls: {\n    overflow: 'hidden',\n    background: 'white',\n    whiteSpace: 'nowrap',\n    position: 'absolute',\n    boxSizing: 'border-box',\n    border: '1px solid #a2a2a2',\n    right: 0,\n    top: 0,\n    zIndex: 1001, // needs to be above overlay but below things that might naturally go on top of it like a context menu from jbrowse-core/ui\n  },\n})\n\nconst DotplotControls = observer(({ model }: { model: DotplotViewModel }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.controls}>\n      <IconButton\n        onClick={() => {\n          model.hview.scroll(-100)\n        }}\n        className={classes.iconButton}\n        title=\"left\"\n        color=\"secondary\"\n      >\n        <ArrowLeft />\n      </IconButton>\n\n      <IconButton\n        onClick={() => {\n          model.hview.scroll(100)\n        }}\n        className={classes.iconButton}\n        title=\"left\"\n        color=\"secondary\"\n      >\n        <ArrowRight />\n      </IconButton>\n      <IconButton\n        onClick={() => {\n          model.vview.scroll(100)\n        }}\n        className={classes.iconButton}\n        title=\"left\"\n        color=\"secondary\"\n      >\n        <ArrowDown />\n      </IconButton>\n      <IconButton\n        onClick={() => {\n          model.vview.scroll(-100)\n        }}\n        className={classes.iconButton}\n        title=\"left\"\n        color=\"secondary\"\n      >\n        <ArrowUp />\n      </IconButton>\n      <IconButton\n        onClick={model.zoomOutButton}\n        className={classes.iconButton}\n        color=\"secondary\"\n      >\n        <ZoomOut />\n      </IconButton>\n\n      <IconButton\n        onClick={model.zoomInButton}\n        className={classes.iconButton}\n        title=\"zoom in\"\n        color=\"secondary\"\n      >\n        <ZoomIn />\n      </IconButton>\n\n      <IconButton\n        onClick={model.activateTrackSelector}\n        title=\"Open track selector\"\n        value=\"track_select\"\n        data-testid=\"circular_track_select\"\n        color=\"secondary\"\n      >\n        <TrackSelectorIcon />\n      </IconButton>\n    </div>\n  )\n})\n\nexport default DotplotControls\n","import { BaseBlock } from '@jbrowse/core/util/blockTypes'\nimport { Dotplot1DViewModel } from '../model'\n\nexport function locstr(px: number, view: Dotplot1DViewModel) {\n  const { refName, start, offset, oob } = view.pxToBp(px)\n  const coord = Math.floor(start + offset)\n  return oob ? 'out of bounds' : `${refName}:${coord.toLocaleString('en-US')}`\n}\n\nexport function getBlockLabelKeysToHide(\n  blocks: BaseBlock[],\n  length: number,\n  viewOffsetPx: number,\n) {\n  const blockLabelKeysToHide: string[] = []\n  const sortedBlocks = blocks.slice(0).sort((a, b) => {\n    const alen = a.end - a.start\n    const blen = b.end - b.start\n    return blen - alen\n  })\n  const positions = new Array(Math.round(length))\n  sortedBlocks.forEach(({ key, offsetPx }) => {\n    const y = Math.round(length - offsetPx + viewOffsetPx)\n    const labelBounds = [Math.max(y - 12, 0), y]\n    if (y === 0 || positions.slice(...labelBounds).some(Boolean)) {\n      blockLabelKeysToHide.push(key)\n    } else {\n      positions.fill(true, ...labelBounds)\n    }\n  })\n  return blockLabelKeysToHide\n}\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(\n  scale: number,\n  minMajorPitchPx: number,\n  minMinorPitchPx: number,\n) {\n  scale = Math.abs(scale)\n  const minMajorPitchBp = minMajorPitchPx * scale\n  const majorMagnitude = parseInt(\n    Number(minMajorPitchBp).toExponential().split(/e/i)[1],\n    10,\n  )\n\n  let majorPitch = 10 ** majorMagnitude\n  while (majorPitch < minMajorPitchBp) {\n    majorPitch *= 2\n    if (majorPitch >= minMajorPitchBp) {\n      break\n    }\n    majorPitch *= 2.5\n  }\n\n  majorPitch = Math.max(majorPitch, 5)\n\n  const majorPitchPx = majorPitch / scale\n\n  let minorPitch = 0\n  if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 10\n  } else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 5\n  } else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 2\n  }\n\n  return { majorPitch, minorPitch }\n}\n\nexport function makeTicks(\n  regions: BaseBlock[],\n  bpPerPx: number,\n  emitMajor = true,\n  emitMinor = true,\n) {\n  const ticks = []\n  const gridPitch = chooseGridPitch(bpPerPx, 60, 15)\n  const iterPitch = gridPitch.minorPitch || gridPitch.majorPitch\n  for (let i = 0; i < regions.length; i++) {\n    const region = regions[i]\n    const { start, end, refName } = region\n    let index = 0\n\n    const minBase = start\n    const maxBase = end\n    for (\n      let base = Math.ceil(minBase / iterPitch) * iterPitch;\n      base < maxBase;\n      base += iterPitch\n    ) {\n      if (emitMinor && base % gridPitch.majorPitch) {\n        ticks.push({ type: 'minor', base: base - 1, index, refName })\n        index += 1\n      } else if (\n        emitMajor &&\n        Math.abs(base - region.start) > gridPitch.minorPitch\n      ) {\n        ticks.push({ type: 'major', base: base - 1, index, refName })\n        index += 1\n      }\n    }\n  }\n  return ticks\n}\n","import React from 'react'\nimport { makeStyles } from '@material-ui/core'\nimport { observer } from 'mobx-react'\nimport { getBlockLabelKeysToHide, makeTicks } from './util'\nimport { DotplotViewModel } from '../model'\n\nconst useStyles = makeStyles(() => ({\n  vtext: {\n    gridColumn: '1/2',\n    gridRow: '1/2',\n    pointerEvents: 'none',\n  },\n  htext: {\n    gridColumn: '2/2',\n    gridRow: '2/2',\n    pointerEvents: 'none',\n  },\n  majorTickLabel: {\n    fontSize: '11px',\n  },\n  majorTick: {\n    stroke: '#555',\n  },\n  minorTick: {\n    stroke: '#999',\n  },\n}))\n\nexport const HorizontalAxis = observer(\n  ({ model }: { model: DotplotViewModel }) => {\n    const classes = useStyles()\n    const { viewWidth, borderY, hview, htextRotation } = model\n    const hide = getBlockLabelKeysToHide(\n      hview.dynamicBlocks.contentBlocks,\n      viewWidth,\n      hview.offsetPx,\n    )\n    const ticks = makeTicks(hview.staticBlocks.contentBlocks, hview.bpPerPx)\n    return (\n      <svg width={viewWidth} height={borderY} className={classes.htext}>\n        <g>\n          {hview.dynamicBlocks.contentBlocks\n            .filter(region => !hide.includes(region.key))\n            .map(region => {\n              const x = region.offsetPx\n              const y = 0\n              return (\n                <text\n                  transform={`rotate(${htextRotation},${\n                    x - hview.offsetPx\n                  },${y})`}\n                  key={JSON.stringify(region)}\n                  x={x - hview.offsetPx}\n                  y={y + 1}\n                  fill=\"#000000\"\n                  dominantBaseline=\"hanging\"\n                  textAnchor=\"end\"\n                >\n                  {`${region.refName}:${\n                    region.start !== 0\n                      ? Math.floor(region.start).toLocaleString('en-US')\n                      : ''\n                  }`}\n                </text>\n              )\n            })}\n          {ticks.map(tick => {\n            const x =\n              (hview.bpToPx({ refName: tick.refName, coord: tick.base }) || 0) -\n              hview.offsetPx\n            return (\n              <line\n                key={`line-${JSON.stringify(tick)}`}\n                x1={x}\n                x2={x}\n                y1={0}\n                y2={tick.type === 'major' ? 6 : 4}\n                strokeWidth={1}\n                stroke={tick.type === 'major' ? '#555' : '#999'}\n                className={\n                  tick.type === 'major' ? classes.majorTick : classes.minorTick\n                }\n                data-bp={tick.base}\n              />\n            )\n          })}\n          {ticks\n            .filter(tick => tick.type === 'major')\n            .map(tick => {\n              const x =\n                (hview.bpToPx({ refName: tick.refName, coord: tick.base }) ||\n                  0) - hview.offsetPx\n              const y = 0\n              return (\n                <text\n                  x={x - 7}\n                  y={y}\n                  transform={`rotate(${htextRotation},${x},${y})`}\n                  key={`text-${JSON.stringify(tick)}`}\n                  style={{ fontSize: '11px' }}\n                  className={classes.majorTickLabel}\n                  dominantBaseline=\"middle\"\n                  textAnchor=\"end\"\n                >\n                  {(tick.base + 1).toLocaleString('en-US')}\n                </text>\n              )\n            })}\n        </g>\n      </svg>\n    )\n  },\n)\nexport const VerticalAxis = observer(\n  ({ model }: { model: DotplotViewModel }) => {\n    const classes = useStyles()\n    const { borderX, viewHeight, vview, vtextRotation } = model\n    const hide = getBlockLabelKeysToHide(\n      vview.dynamicBlocks.contentBlocks,\n      viewHeight,\n      vview.offsetPx,\n    )\n    const ticks = makeTicks(vview.staticBlocks.contentBlocks, vview.bpPerPx)\n    return (\n      <svg className={classes.vtext} width={borderX} height={viewHeight}>\n        <g>\n          {vview.dynamicBlocks.contentBlocks\n            .filter(region => !hide.includes(region.key))\n            .map(region => {\n              const y = region.offsetPx\n              const x = borderX\n              return (\n                <text\n                  transform={`rotate(${vtextRotation},${x},${y})`}\n                  key={JSON.stringify(region)}\n                  x={borderX}\n                  y={viewHeight - y + vview.offsetPx}\n                  fill=\"#000000\"\n                  textAnchor=\"end\"\n                >\n                  {`${region.refName}:${\n                    region.start !== 0 ? Math.floor(region.start) : ''\n                  }`}\n                </text>\n              )\n            })}\n          {ticks.map(tick => {\n            const y =\n              (vview.bpToPx({ refName: tick.refName, coord: tick.base }) || 0) -\n              vview.offsetPx\n            return (\n              <line\n                key={`line-${JSON.stringify(tick)}`}\n                y1={viewHeight - y}\n                y2={viewHeight - y}\n                x1={borderX}\n                x2={borderX - (tick.type === 'major' ? 6 : 4)}\n                strokeWidth={1}\n                stroke={tick.type === 'major' ? '#555' : '#999'}\n                className={\n                  tick.type === 'major' ? classes.majorTick : classes.minorTick\n                }\n                data-bp={tick.base}\n              />\n            )\n          })}\n          {ticks\n            .filter(tick => tick.type === 'major')\n            .map(tick => {\n              const y =\n                (vview.bpToPx({ refName: tick.refName, coord: tick.base }) ||\n                  0) - vview.offsetPx\n              return (\n                <text\n                  y={viewHeight - y - 3}\n                  x={borderX - 7}\n                  key={`text-${JSON.stringify(tick)}`}\n                  textAnchor=\"end\"\n                  dominantBaseline=\"hanging\"\n                  style={{ fontSize: '11px' }}\n                  className={classes.majorTickLabel}\n                >\n                  {(tick.base + 1).toLocaleString('en-US')}\n                </text>\n              )\n            })}\n        </g>\n      </svg>\n    )\n  },\n)\n","import React, { useState, useEffect, useRef } from 'react'\nimport { observer } from 'mobx-react'\nimport { transaction } from 'mobx'\nimport { makeStyles, LinearProgress } from '@material-ui/core'\nimport { getConf } from '@jbrowse/core/configuration'\nimport { Menu } from '@jbrowse/core/ui'\nimport normalizeWheel from 'normalize-wheel'\nimport { DotplotViewModel } from '../model'\nimport ImportForm from './ImportForm'\nimport Controls from './Controls'\nimport { locstr } from './util'\nimport { HorizontalAxis, VerticalAxis } from './Axes'\n\nconst useStyles = makeStyles(theme => ({\n  spacer: {\n    gridColumn: '1/2',\n    gridRow: '2/2',\n  },\n  root: {\n    position: 'relative',\n    marginBottom: theme.spacing(1),\n    overflow: 'hidden',\n  },\n  viewContainer: {\n    marginTop: '3px',\n  },\n  container: {\n    display: 'grid',\n    padding: 5,\n    position: 'relative',\n  },\n  overlay: {\n    pointerEvents: 'none',\n    overflow: 'hidden',\n    display: 'flex',\n    width: '100%',\n    gridRow: '1/2',\n    gridColumn: '2/2',\n    zIndex: 100, // needs to be below controls\n    '& path': {\n      cursor: 'crosshair',\n      fill: 'none',\n    },\n  },\n\n  content: {\n    gridColumn: '2/2',\n    gridRow: '1/2',\n  },\n\n  popover: {\n    background: '#fff',\n    maxWidth: 400,\n    wordBreak: 'break-all',\n    zIndex: 1000,\n    border: '1px solid black',\n    pointerEvents: 'none',\n    position: 'absolute',\n  },\n}))\n\ntype Coord = [number, number] | undefined\ntype Timer = ReturnType<typeof setTimeout>\ntype Rect = { left: number; top: number }\n\nconst Grid = observer(\n  ({\n    model,\n    children,\n    stroke = '#000a',\n  }: {\n    model: DotplotViewModel\n    children: React.ReactNode\n    stroke?: string\n  }) => {\n    const { viewWidth, viewHeight, hview, vview } = model\n    const hblocks = hview.dynamicBlocks.contentBlocks\n    const vblocks = vview.dynamicBlocks.contentBlocks\n    const htop = hview.displayedRegionsTotalPx - hview.offsetPx\n    const hbottom = hblocks[0].offsetPx - hview.offsetPx\n    const vtop = vview.displayedRegionsTotalPx - vview.offsetPx\n    const vbottom = vblocks[0].offsetPx - vview.offsetPx\n    return (\n      <svg\n        style={{ background: 'rgba(0,0,0,0.12)' }}\n        width={viewWidth}\n        height={viewHeight}\n      >\n        <rect\n          x={hbottom}\n          y={viewHeight - vtop}\n          width={htop - hbottom}\n          height={vtop - vbottom}\n          fill=\"#fff\"\n        />\n        <g>\n          {hblocks.map(region => {\n            const x = region.offsetPx - hview.offsetPx\n            return (\n              <line\n                key={JSON.stringify(region)}\n                x1={x}\n                y1={0}\n                x2={x}\n                y2={viewHeight}\n                stroke={stroke}\n              />\n            )\n          })}\n          {vblocks.map(region => {\n            const y = viewHeight - (region.offsetPx - vview.offsetPx)\n            return (\n              <line\n                key={JSON.stringify(region)}\n                x1={0}\n                y1={y}\n                x2={viewWidth}\n                y2={y}\n                stroke={stroke}\n              />\n            )\n          })}\n          <line x1={htop} y1={0} x2={htop} y2={viewHeight} stroke={stroke} />\n          <line\n            x1={0}\n            y1={viewHeight - vtop}\n            x2={viewWidth}\n            y2={viewHeight - vtop}\n            stroke={stroke}\n          />\n        </g>\n        {children}\n      </svg>\n    )\n  },\n)\n// produces offsetX/offsetY coordinates from a clientX and an element's\n// getBoundingClientRect\nfunction getOffset(coord: Coord, rect: Rect) {\n  return coord && ([coord[0] - rect.left, coord[1] - rect.top] as Coord)\n}\n\nconst DotplotViewInternal = observer(\n  ({ model }: { model: DotplotViewModel }) => {\n    const { hview, vview, viewHeight } = model\n    const classes = useStyles()\n    const [mousecurrClient, setMouseCurrClient] = useState<Coord>()\n    const [mousedownClient, setMouseDownClient] = useState<Coord>()\n    const [mouseupClient, setMouseUpClient] = useState<Coord>()\n    const ref = useRef<HTMLDivElement>(null)\n    const root = useRef<HTMLDivElement>(null)\n    const distanceX = useRef(0)\n    const distanceY = useRef(0)\n    const lref = useRef<HTMLDivElement>(null)\n    const rref = useRef<HTMLDivElement>(null)\n    const timeout = useRef<Timer>()\n    const delta = useRef(0)\n    const scheduled = useRef(false)\n    const blank = { left: 0, top: 0, width: 0, height: 0 }\n    const svg = ref.current?.getBoundingClientRect() || blank\n    const rrect = rref.current?.getBoundingClientRect() || blank\n    const lrect = lref.current?.getBoundingClientRect() || blank\n    const mousedown = getOffset(mousedownClient, svg)\n    const mousecurr = getOffset(mousecurrClient, svg)\n    const mouseup = getOffset(mouseupClient, svg)\n    const mouserect = mouseup || mousecurr\n\n    // use non-React wheel handler to properly prevent body scrolling\n    useEffect(() => {\n      function onWheel(origEvent: WheelEvent) {\n        const event = normalizeWheel(origEvent)\n        origEvent.preventDefault()\n        if (origEvent.ctrlKey === true) {\n          delta.current += event.pixelY / 500\n          model.vview.setScaleFactor(\n            delta.current < 0 ? 1 - delta.current : 1 / (1 + delta.current),\n          )\n          model.hview.setScaleFactor(\n            delta.current < 0 ? 1 - delta.current : 1 / (1 + delta.current),\n          )\n          if (timeout.current) {\n            clearTimeout(timeout.current)\n          }\n          timeout.current = setTimeout(() => {\n            transaction(() => {\n              model.hview.setScaleFactor(1)\n              model.vview.setScaleFactor(1)\n              model.hview.zoomTo(\n                delta.current > 0\n                  ? model.hview.bpPerPx * (1 + delta.current)\n                  : model.hview.bpPerPx / (1 - delta.current),\n              )\n              model.vview.zoomTo(\n                delta.current > 0\n                  ? model.vview.bpPerPx * (1 + delta.current)\n                  : model.vview.bpPerPx / (1 - delta.current),\n              )\n            })\n            delta.current = 0\n          }, 300)\n        } else {\n          distanceX.current += event.pixelX\n          distanceY.current -= event.pixelY\n          if (!scheduled.current) {\n            scheduled.current = true\n\n            window.requestAnimationFrame(() => {\n              transaction(() => {\n                model.hview.scroll(distanceX.current)\n                model.vview.scroll(distanceY.current)\n              })\n              scheduled.current = false\n              distanceX.current = 0\n              distanceY.current = 0\n            })\n          }\n        }\n      }\n      if (ref.current) {\n        const curr = ref.current\n        curr.addEventListener('wheel', onWheel)\n        return () => {\n          curr.removeEventListener('wheel', onWheel)\n        }\n      }\n      return () => {}\n    }, [model.hview, model.vview])\n\n    useEffect(() => {\n      function globalMouseMove(event: MouseEvent) {\n        setMouseCurrClient([event.clientX, event.clientY])\n      }\n\n      window.addEventListener('mousemove', globalMouseMove)\n      return () => {\n        window.removeEventListener('mousemove', globalMouseMove)\n      }\n    }, [])\n\n    // detect a mouseup after a mousedown was submitted, autoremoves mouseup\n    // once that single mouseup is set\n    useEffect(() => {\n      let cleanup = () => {}\n\n      function globalMouseUp(event: MouseEvent) {\n        if (\n          mousedown &&\n          mousecurr &&\n          Math.abs(mousedown[0] - mousecurr[0]) > 3 &&\n          Math.abs(mousedown[1] - mousecurr[1]) > 3\n        ) {\n          setMouseUpClient([event.clientX, event.clientY])\n        } else {\n          setMouseDownClient(undefined)\n        }\n      }\n\n      if (mousedown && !mouseup) {\n        window.addEventListener('mouseup', globalMouseUp, true)\n        cleanup = () => {\n          window.removeEventListener('mouseup', globalMouseUp, true)\n        }\n      }\n      return cleanup\n    }, [mousedown, mousecurr, mouseup])\n\n    return (\n      <div ref={root} className={classes.root}>\n        <Controls model={model} />\n\n        <div className={classes.container}>\n          <div\n            style={{\n              display: 'grid',\n              transform: `scaleX(${model.hview.scaleFactor}) scaleY(${model.vview.scaleFactor})`,\n            }}\n          >\n            <VerticalAxis model={model} />\n            <HorizontalAxis model={model} />\n            <div\n              ref={ref}\n              style={{ position: 'relative' }}\n              className={classes.content}\n            >\n              {mouserect ? (\n                <div\n                  ref={lref}\n                  className={classes.popover}\n                  style={{\n                    left:\n                      mouserect[0] -\n                      (mousedown && mouserect[0] - mousedown[0] < 0\n                        ? lrect.width\n                        : 0),\n                    top:\n                      mouserect[1] -\n                      (mousedown && mouserect[1] - mousedown[1] < 0\n                        ? lrect.height\n                        : 0),\n                  }}\n                >\n                  {`x-${locstr(mouserect[0], hview)}`}\n                  <br />\n                  {`y-${locstr(viewHeight - mouserect[1], vview)}`}\n                </div>\n              ) : null}\n              {mousedown &&\n              mouserect &&\n              Math.abs(mousedown[0] - mouserect[0]) > 3 &&\n              Math.abs(mousedown[1] - mouserect[1]) > 3 ? (\n                <div\n                  ref={rref}\n                  className={classes.popover}\n                  style={{\n                    left:\n                      mousedown[0] -\n                      (mouserect[0] - mousedown[0] < 0 ? 0 : rrect.width),\n                    top:\n                      mousedown[1] -\n                      (mouserect[1] - mousedown[1] < 0 ? 0 : rrect.height),\n                  }}\n                >\n                  {`x-${locstr(mousedown[0], hview)}`}\n                  <br />\n                  {`y-${locstr(viewHeight - mousedown[1], vview)}`}\n                </div>\n              ) : null}\n\n              <div\n                role=\"presentation\"\n                style={{ cursor: 'crosshair' }}\n                onMouseDown={event => {\n                  if (event.button === 0) {\n                    setMouseDownClient([event.clientX, event.clientY])\n                    setMouseCurrClient([event.clientX, event.clientY])\n                  }\n                }}\n              >\n                <Grid model={model}>\n                  {mousedown && mouserect ? (\n                    <rect\n                      fill=\"rgba(255,0,0,0.3)\"\n                      x={Math.min(mouserect[0], mousedown[0])}\n                      y={Math.min(mouserect[1], mousedown[1])}\n                      width={Math.abs(mouserect[0] - mousedown[0])}\n                      height={Math.abs(mouserect[1] - mousedown[1])}\n                    />\n                  ) : null}\n                </Grid>\n              </div>\n              <div className={classes.spacer} />\n            </div>\n            <div className={classes.overlay}>\n              {model.tracks.map(track => {\n                const [display] = track.displays\n                const { RenderingComponent } = display\n\n                return RenderingComponent ? (\n                  <RenderingComponent\n                    key={getConf(track, 'trackId')}\n                    model={display}\n                  />\n                ) : null\n              })}\n            </div>\n            <Menu\n              open={Boolean(mouseup)}\n              onMenuItemClick={(_, callback) => {\n                callback()\n                setMouseUpClient(undefined)\n                setMouseDownClient(undefined)\n              }}\n              onClose={() => {\n                setMouseUpClient(undefined)\n                setMouseDownClient(undefined)\n              }}\n              anchorReference=\"anchorPosition\"\n              anchorPosition={\n                mouseupClient\n                  ? {\n                      top: mouseupClient[1] + 30,\n                      left: mouseupClient[0] + 30,\n                    }\n                  : undefined\n              }\n              style={{ zIndex: 1000 }}\n              menuItems={[\n                {\n                  label: 'Zoom in',\n                  onClick: () => {\n                    if (mousedown && mouseup) {\n                      model.zoomIn(mousedown, mouseup)\n                    }\n                  },\n                },\n                {\n                  label: 'Open linear synteny view',\n                  onClick: () => {\n                    if (mousedown && mouseup) {\n                      model.onDotplotView(mousedown, mouseup)\n                    }\n                  },\n                },\n              ]}\n            />\n          </div>\n        </div>\n      </div>\n    )\n  },\n)\nconst DotplotView = observer(({ model }: { model: DotplotViewModel }) => {\n  const { initialized, loading, error } = model\n\n  if ((!initialized && !loading) || error) {\n    return <ImportForm model={model} />\n  }\n\n  if (loading) {\n    return (\n      <div>\n        <p>Loading...</p>\n        <LinearProgress />\n      </div>\n    )\n  }\n\n  return <DotplotViewInternal model={model} />\n})\n\nexport default DotplotView\n"],"sourceRoot":""}